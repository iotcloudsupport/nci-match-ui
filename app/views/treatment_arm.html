<div ng-controller="TreatmentArmController" ng-init="loadTreatmentArmDetails()">

    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-lg-10">
            <h2>Treatment Arm</h2>
            <ol class="breadcrumb">
                <li>
                    <a ui-sref="dashboard">Dashboard</a>
                </li>
                <li class="active">
                    <a ui-sref="treatment-arms">Treatment Arms</a>
                </li>
                <li class="active">
                    <strong>Treatment Arm <treatment-arm-title name="name" version="version" stratum="stratum" no-url="true"></treatment-arm-title></strong>
                </li>
            </ol>
        </div>
        <div class="col-lg-2"></div>
    </div>

    <div class="wrapper animated fadeInRight">
        <div class="no-horizontal-padding header-box-container">
            <div class="row">
                <div class="col-lg-6 col-md-6">
                    <div id="left-info-box" class="header-info-box ta-header-box">
                        <dl class="dl-horizontal">
                            <dt>Name</dt>
                            <dd>{{currentVersion.name}}</dd>

                            <dt>Stratum ID</dt>
                            <dd>{{currentVersion.stratum_id}}</dd>

                            <dt>Description</dt>
                            <dd>{{currentVersion.description}}</dd>

                            <dt>Status</dt>
                            <dd ng-style="{'color':'{{ currentVersion.treatment_arm_status | taStatus }}'}">{{currentVersion.treatment_arm_status}}</dd>

                            <dt><span class="drop-down-label">Version</span></dt>
                            <dd>
                                <div class="btn-group" uib-dropdown dropdown-append-to-body>
                                    <button id="btn-append-to-body" type="button" class="btn btn-success btn-outline" uib-dropdown-toggle>{{currentVersion.version}}<span class="caret"></span></button>
                                    <ul class="dropdown-menu" uib-dropdown-menu role="menu">
                                        <li ng-repeat="item in versions" role="menuitem"><a href ng-click="onVersionSelected(item)">{{item.version}}</a></li>
                                    </ul>
                                </div>
                            </dd>

                            <dt></dt>
                            <dd ng-style="selectedVersion.latest === 'This is the latest version.' && {'color':'green'} || selectedVersion.latest === 'This is not the latest version.' && {'color': 'red'}">
                                {{selectedVersion.latest}}
                            </dd>
                        </dl>
                    </div>
                </div>

                <div class="col-lg-6 col-md-6">
                    <div id="right-info-box" class="header-info-box ta-header-box">
                        <dl class="dl-horizontal">
                            <dt>Gene(s)</dt>
                            <dd>{{currentVersion.gene}}</dd>

                            <dt>Patients on Arm Version</dt>
                            <dd>{{currentVersion.num_patients_assigned | dashify}}</dd>

                            <dt>Total Patients on Arm</dt>
                            <dd>{{currentVersion.num_patients_assigned_basic | dashify}}</dd>

                            <dt>Drug(s)</dt>
                            <dd><span ng-repeat="drug in currentVersion.treatment_arm_drugs">{{drug.name}}{{$last?'':', '}}</span></dd>

                            <dt>Download</dt>
                            <dd>
                                <button class="btn btn-outline btn-success" title="Export Variant Report to PDF"><i class="fa fa-file-pdf-o"></i> PDF</button>
                                <button class="btn btn-outline btn-success" title="Export Variant Report to Excel"><i class="fa fa-file-excel-o"></i>&nbsp;Excel</button>
                                <button class="btn btn-outline btn-success" title="Export Pharma Report"><i class="fa fa-file-text-o"></i>&nbsp;Pharma</button>
                            </dd>

                        </dl>
                    </div>
                </div>
            </div>
        </div>

        <div class="tabs-container no-tab-pane-border">
            <uib-tabset>
                <uib-tab heading="Analysis">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title ibox-title-no-line-no-padding">
                                        <h3>Patient Assignment Outcome</h3>
                                    </div>
                                    <div class="ibox-content ibox-content-no-border">
                                        <div style="float:left">
                                            <div id="legendContainer" style="text-align:left;overflow-y:auto"></div>
                                        </div>
                                        <div id="patientPieChartContainer" class="flot-chart" style="height:360px;padding:40px 0px 20px 100px">
                                            <flot id="patientPieChart" options="patientPieChartOptions" dataset="patientPieChartDataset" height="100%"></flot>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title ibox-title-no-line-no-padding">
                                        <h3>Diseases Represented In Assignments To This Treatment Arm</h3>
                                    </div>
                                    <div class="ibox-content ibox-content-no-border">
                                        <div style="float:left">
                                            <div id="diseaseLegendContainer" style="text-align:left;overflow-y:auto"></div>
                                        </div>
                                        <div id="diseasePieChartContainer" class="flot-chart" style="height:360px;padding:40px 0px 20px 100px">
                                            <flot id="diseasePieChart" options="diseasePieChartOptions" dataset="diseasePieChartDataset" height="100%"></flot>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="allPatientsData" grid-data grid-options="allPatientsDataGridOptions" grid-actions="gridActions" class="data-grid">
                            <div class="row">
                                <div class="col pull-left">
                                    <form class="form-inline">
                                        <div class="form-group">
                                            <div class="items-per-page">
                                                <label for="itemsOnPageSelect2">Show</label>
                                                <select id="itemsOnPageSelect2" class="form-control input-sm" ng-init="paginationOptions.itemsPerPage = '10'" ng-model="paginationOptions.itemsPerPage" ng-change="reloadGrid()">
                                                    <option>10</option>
                                                    <option>25</option>
                                                    <option>50</option>
                                                </select>
                                                <label for="itemsOnPageSelect2">per page</label>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="col pull-right">
                                    <div class="grid-filter">
                                        <input type="text" class="form-control input-sm order-search-box"
                                               placeholder="Filter by all columns"
                                               grid-id="pendingTissueVRs"
                                               ng-change="gridActions.filter()"
                                               ng-model="filterAll"
                                               filter-by="filterAll"
                                               filter-type="text">
                                    </div>
                                </div>
                            </div>

                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th sortable="slot" class="sortable">Slot</th>
                                    <th sortable="patient_id" class="sortable">Patient ID</th>
                                    <th sortable="treatmentArmVersion" class="sortable">TA Version</th>
                                    <th sortable="patientAssignmentStatusOutcome" class="sortable">Patient Assignment Status Outcome</th>
                                    <th class="text-center">Variant Report</th>
                                    <th class="text-center">Assignment Report</th>
                                    <th sortable="dateSelected" class="sortable">Date Selected</th>
                                    <th sortable="dateOnArm" class="sortable">Date On Arm</th>
                                    <th sortable="dateOffArm" class="sortable">Date Off Arm</th>
                                    <th sortable="timeOnArm" class="sortable">Time On Arm</th>
                                    <th sortable="step" class="sortable">Step</th>
                                    <th sortable="diseases" class="sortable">Disease</th>
                                    <th sortable="reason" class="sortable">Reason</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr grid-item>
                                    <td ng-bind="item.slot | dashify"></td>
                                    <td>
                                        <a ui-sref="patient({patient_id: item.patient_id})">
                                            <i class="fa fa-user"></i><span ng-bind="item.patient_id | dashify"></span>
                                        </a>
                                    </td>
                                    <td ng-bind="item.treatmentArmVersion | dashify"></td>
                                    <td ng-bind="item.patientAssignmentStatusOutcome"></td> <!-- need to add color by piping to patientStatus -->
                                    <td>
                                        <a ui-sref="patient({ patient_id: item.patient_id, section: 'tissue_variant_report', molecular_id: item.molecular_id, analysis_id: item.analysis_id })"
                                           title="Variant Report">
                                            <i class="fa fa-file-text-o"></i>
                                        </a>
                                    </td>
                                    <td class="text-center">
                                        <a ui-sref="patient({ patient_id: item.patient_id, section: 'assignment_report', molecular_id: item.molecular_id, analysis_id: item.analysis_id })"
                                           title="Assignment Report">
                                            <i class="fa fa-file-text-o"></i>
                                        </a>
                                    </td>
                                    <td ng-bind="item.dateSelected | dashify"></td>
                                    <td ng-bind="item.dateOnArm | dashify"></td>
                                    <td ng-bind="item.dateOffArm | dashify"></td>
                                    <td ng-bind="item.timeOnArm | dashify"></td>
                                    <td ng-bind="item.step | dashify"></td>
                                    <td ng-bind="item.diseases | dashify"></td>
                                    <td ng-bind="item.reason | dashify"></td>
                                </tr>
                                <tr ng-if="!allPatientDataGridOptions.data || !allPatientDataGridOptions.data.length" class="no-data-message">
                                    <td colspan="13" class="text-muted">No patients have been assigned to this treatment arm</td>
                                </tr>
                                </tbody>
                            </table>

                            <form class="form-inline pull-left">
                                <div class="form-group">
                                    <grid-pagination max-size="5" class="pagination-sm" total-items="paginationOptions.totalItems" ng-model="paginationOptions.currentPage"
                                                     ng-change="reloadGrid()" items-per-page="paginationOptions.itemsPerPage"></grid-pagination>
                                </div>
                            </form>
                        </div>

                    </div>
                </uib-tab>

                <uib-tab heading="Rules">
                    <div class="panel-body">
                        <div class="tabs-container">
                            <uib-tabset>
                                <uib-tab heading="Drugs / Diseases">
                                    <div class="panel-body">
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <div id="exclusionaryDiseases" grid-data grid-options="exclusionaryDiseasesGridOptions" grid-actions="gridActions" class="data-grid">
                                                    <div class="col pull-left">
                                                        <div>
                                                            <h3>Exclusionary Diseases</h3><br>
                                                        </div>

                                                    </div>
                                                    <div class="col pull-right">
                                                        <div class="grid-filter">
                                                            <input type="text" class="form-control input-sm order-search-box"
                                                                   placeholder="Filter by all columns"
                                                                   grid-id="exclusionaryDiseases"
                                                                   ng-change="gridActions.filter()"
                                                                   ng-model="filterAll"
                                                                   filter-by="filterAll"
                                                                   filter-type="text">
                                                        </div>
                                                    </div>
                                                </div>
                                                <table class="table table-striped">
                                                    <thead>
                                                    <tr>
                                                        <th sortable="disease_code" class="sortable">Code</th>
                                                        <th sortable="short_name" class="sortable">Name</th>
                                                        <th sortable="ctep_category" class="sortable">Type</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr grid-item>

                                                        <td ng-bind="item.disease_code | dashify"></td>
                                                        <td ng-bind="item.short_name | dashify"></td>
                                                        <td ng-bind="item.ctep_category | dashify"></td>

                                                    </tr>
                                                    <tr ng-if="!exclusionaryDiseasesGridOptions.data || !exclusionaryDiseasesGridOptions.data.length" class="no-data-message">
                                                        <td colspan="3" class="text-muted">No exclusionary diseases</td>
                                                    </tr>
                                                    </tbody>
                                                </table>

                                                <form class="form-inline pull-left">
                                                    <div class="form-group">
                                                        <grid-pagination max-size="5" class="pagination-sm" total-items="paginationOptions.totalItems" ng-model="paginationOptions.currentPage"
                                                                         ng-change="reloadGrid()" items-per-page="paginationOptions.itemsPerPage"></grid-pagination>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="col-lg-6">
                                                <div id="inclusionaryDiseases" grid-data grid-options="inclusionaryDiseasesGridOptions" grid-actions="gridActions" class="data-grid">
                                                    <div class="col pull-left">
                                                        <div>
                                                            <h3>Inclusionary Diseases</h3><br>
                                                        </div>

                                                    </div>
                                                    <div class="col pull-right">
                                                        <div class="grid-filter">
                                                            <input type="text" class="form-control input-sm order-search-box"
                                                                   placeholder="Filter by all columns"
                                                                   grid-id="inclusionaryDiseases"
                                                                   ng-change="gridActions.filter()"
                                                                   ng-model="filterAll"
                                                                   filter-by="filterAll"
                                                                   filter-type="text">
                                                        </div>
                                                    </div>
                                                </div>
                                                <table class="table table-striped">
                                                    <thead>
                                                    <tr>
                                                        <th sortable="disease_code" class="sortable">Code</th>
                                                        <th sortable="short_name" class="sortable">Name</th>
                                                        <th sortable="ctep_category" class="sortable">Type</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr grid-item>

                                                        <td ng-bind="item.disease_code | dashify"></td>
                                                        <td ng-bind="item.short_name | dashify"></td>
                                                        <td ng-bind="item.ctep_category | dashify"></td>

                                                    </tr>
                                                    <tr ng-if="!inclusionaryDiseasesGridOptions.data || !inclusionaryDiseasesGridOptions.data.length" class="no-data-message">
                                                        <td colspan="3" class="text-muted">No inclusionary diseases</td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                                <form class="form-inline pull-left">
                                                    <div class="form-group">
                                                        <grid-pagination max-size="5" class="pagination-sm" total-items="paginationOptions.totalItems" ng-model="paginationOptions.currentPage"
                                                                         ng-change="reloadGrid()" items-per-page="paginationOptions.itemsPerPage"></grid-pagination>
                                                    </div>
                                                </form>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <div id="exclusionaryDrugs" grid-data grid-options="exclusionaryDrugsGridOptions" grid-actions="gridActions" class="data-grid">
                                                    <div class="col pull-left">
                                                        <div>
                                                            <h3>Exclusionary Drugs</h3><br>
                                                        </div>

                                                    </div>
                                                    <div class="col pull-right">
                                                        <div class="grid-filter">
                                                            <input type="text" class="form-control input-sm order-search-box"
                                                                   placeholder="Filter by all columns"
                                                                   grid-id="exclusionaryDrugs"
                                                                   ng-change="gridActions.filter()"
                                                                   ng-model="filterAll"
                                                                   filter-by="filterAll"
                                                                   filter-type="text">
                                                        </div>
                                                    </div>
                                                </div>
                                                <table class="table table-striped">
                                                    <thead>
                                                    <tr>
                                                        <th sortable="drug_id" class="sortable">ID</th>
                                                        <th sortable="name" class="sortable">Name</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr grid-item>

                                                        <td ng-bind="item.drug_id | dashify"></td>
                                                        <td ng-bind="item.name | dashify"></td>
                                                    </tr>
                                                    <tr ng-if="!exclusionaryDrugsGridOptions.data || !exclusionaryDrugsGridOptions.data.length" class="no-data-message">
                                                        <td colspan="3" class="text-muted">No exclusionary drugs</td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                                <form class="form-inline pull-left">
                                                    <div class="form-group">
                                                        <grid-pagination max-size="5" class="pagination-sm" total-items="paginationOptions.totalItems" ng-model="paginationOptions.currentPage"
                                                                         ng-change="reloadGrid()" items-per-page="paginationOptions.itemsPerPage"></grid-pagination>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>

                                    </div>
                                </uib-tab>

                                <uib-tab heading="SNVs / MNVs / Indels">
                                    <div class="panel-body">
                                            <div id="snvsMnvsIndels" grid-data grid-options="snvsMnvsIndelsGridOptions" grid-actions="gridActions" class="data-grid">
                                                <div class="row">
                                                    <div class="col pull-left">
                                                        <form class="form-inline">
                                                            <div class="form-group">
                                                                <div class="items-per-page">
                                                                    <label for="itemsOnPageSelectSnv">Show</label>
                                                                    <select id="itemsOnPageSelectSnv" class="form-control input-sm" ng-init="paginationOptions.itemsPerPage = '10'" ng-model="paginationOptions.itemsPerPage"
                                                                            ng-change="reloadGrid()">
                                                                        <option>10</option>
                                                                        <option>25</option>
                                                                        <option>50</option>
                                                                        <option>100</option>
                                                                    </select>
                                                                    <label for="itemsOnPageSelectSnv">per page</label>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                    <div class="col pull-right">
                                                        <div class="grid-filter">
                                                            <input type="text" class="form-control input-sm order-search-box" placeholder="Filter by all columns" grid-id="snvsMnvsIndels"
                                                                   ng-change="gridActions.filter()" ng-model="filterAll" filter-by="filterAll" filter-type="text">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="btn-group">
                                                    <div class="btn-group btn-group-margin" data-toggle="buttons">
                                                        <label class="btn btn-outline btn-success" ng-class="getInExclusionTypeClass('inclusion')" ng-click="setInExclusionType('inclusion')"
                                                               title="Switch to Inclusion">
                                                            <input type="radio" name="inExclusionType" id="option1">INCLUSION
                                                        </label>
                                                        <label class="btn btn-outline btn-success" ng-class="getInExclusionTypeClass('exclusion')" ng-click="setInExclusionType('exclusion')"
                                                               title="Switch to Exclusion">
                                                            <input type="radio" name="inExclusionType" id="option2">EXCLUSION
                                                        </label>
                                                    </div>
                                                </div>
                                                <br><br>
                                                <div class="row" ng-if="inExclusionType === 'inclusion'">
                                                    <table class="table table-striped">
                                                        <thead>
                                                            <tr>
                                                                <th sortable="identifier" class="sortable">ID</th>
                                                                <th sortable="chromosome" class="sortable">Chrom <i class="fa fa-question-circle" data-placement="top"
                                                                             title="{{tooltipContent.chr}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="position" class="sortable">Position</th>
                                                                <th sortable="cds_reference" class="sortable">CDS Ref <i class="fa fa-question-circle" data-placement="top"
                                                                               title="{{tooltipContent.ref}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="cds_alternative" class="sortable">CDS Alt <i class="fa fa-question-circle" data-placement="top"
                                                                               title="{{tooltipContent.alt}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="ocp_reference" class="sortable">OCP Ref <i class="fa fa-question-circle" data-placement="top"
                                                                               title="{{tooltipContent.ref}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="ocp_alternative" class="sortable">OCP Alt <i class="fa fa-question-circle" data-placement="top"
                                                                               title="{{tooltipContent.alt}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="strand" class="sortable">Strand <i class="fa fa-question-circle" data-placement="top"
                                                                              title="{{tooltipContent.alt}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="level_of_evidence" class="sortable">LOE <i class="fa fa-question-circle" data-placement="top"
                                                                           title="{{tooltipContent.loe}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th class="text-center">Lit <i class="fa fa-question-circle" data-placement="top"
                                                                           title="{{tooltipContent.lit}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="num_patients_with_variant" class="sortable">Total # Of Patients With Variant</th>
                                                                <th sortable="num_patients_with_variant_on_arm" class="sortable">Patients With Variant Who Were Assigned To This Arm</th>
                                                                <th sortable="percent_patients_with_variant_on_arm" class="sortable">% Of Patients With Variant On Arm Of Total Patients With
                                                                    Variant
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr grid-item ng-model="version">
                                                                <td><a ng-click="openId(item.identifier)"><span ng-bind="item.identifier | dashify"></span></a></td>
                                                                <td ng-bind="item.chromosome | dashify"></td>
                                                                <td ng-bind="item.position | dashify"></td>
                                                                <td ng-bind="item.cds_reference | dashify"></td>
                                                                <td ng-bind="item.cds_alternative | dashify"></td>
                                                                <td ng-bind="item.ocp_reference | dashify"></td>
                                                                <td ng-bind="item.ocp_alternative | dashify"></td>
                                                                <td ng-bind="item.strand | dashify"></td>
                                                                <td ng-bind="item.level_of_evidence | dashify"></td>
                                                                <td>
                                                                    <table>
                                                                        <tr ng-repeat="subitem in item.public_med_ids">
                                                                            <td><a ng-click="openPubMed(subitem)">{{subitem | dashify }}</a></td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                                <td ng-bind="item.num_patients_with_variant | dashify" style="text-align:right"></td>
                                                                <td ng-bind="item.num_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                                <td ng-bind="item.percent_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                            </tr>
                                                            <tr ng-if="!snvsMnvsIndelsGridOptions.data || !snvsMnvsIndelsGridOptions.data.length" class="no-data-message">
                                                                <td colspan="13" class="text-muted">No inclusion SNVs / MNVs / Indels</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <form class="form-inline pull-left">
                                                        <div class="form-group">
                                                            <grid-pagination max-size="5" class="pagination-sm" total-items="paginationOptions.totalItems" ng-model="paginationOptions.currentPage"
                                                                             ng-change="reloadGrid()" items-per-page="paginationOptions.itemsPerPage"></grid-pagination>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="row" ng-if="inExclusionType === 'exclusion'">
                                                    <table class="table table-striped">
                                                        <thead>
                                                        <tr>
                                                            <th sortable="identifier" class="sortable">ID</th>
                                                            <th sortable="chromosome" class="sortable">Chrom <i class="fa fa-question-circle" data-placement="top" title="{{tooltipContent.chr}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                            <th sortable="position" class="sortable">Position</th>
                                                            <th sortable="cds_reference" class="sortable">CDS Ref <i class="fa fa-question-circle" data-placement="top" title="{{tooltipContent.ref}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                            <th sortable="cds_alternative" class="sortable">CDS Alt <i class="fa fa-question-circle" data-placement="top" title="{{tooltipContent.alt}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                            <th sortable="ocp_reference" class="sortable">OCP Ref <i class="fa fa-question-circle" data-placement="top" title="{{tooltipContent.ref}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                            <th sortable="ocp_alternative" class="sortable">OCP Alt <i class="fa fa-question-circle" data-placement="top" title="{{tooltipContent.alt}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                            <<th sortable="strand" class="sortable">Strand <i class="fa fa-question-circle" data-placement="top"
                                                                                                              title="{{tooltipContent.alt}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                            <th class="text-center">Lit <i class="fa fa-question-circle" data-placement="top"
                                                                                           title="{{tooltipContent.lit}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                            <th sortable="num_patients_with_variant" class="sortable">Total # Of Patients With Variant</th>
                                                            <th sortable="num_patients_with_variant_on_arm" class="sortable">Patients With Variant Who Were Excluded From This Arm</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr grid-item ng-model="version">
                                                                <td><a ng-click="openId(item.identifier)"><span ng-bind="item.identifier | dashify"></span></a></td>
                                                                <td ng-bind="item.chromosome | dashify"></td>
                                                                <td ng-bind="item.position | dashify"></td>
                                                                <td ng-bind="item.cds_reference | dashify"></td>
                                                                <td ng-bind="item.cds_alternative | dashify"></td>
                                                                <td ng-bind="item.ocp_reference | dashify"></td>
                                                                <td ng-bind="item.ocp_alternative | dashify"></td>
                                                                <td ng-bind="item.strand | dashify"></td>
                                                                <td>
                                                                    <table>
                                                                        <tr ng-repeat="subitem in item.public_med_ids">
                                                                            <td><a ng-click="openPubMed(subitem)">{{subitem | dashify }}</a></td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                                <td ng-bind="item.num_patients_with_variant | dashify" style="text-align:right"></td>
                                                                <td ng-bind="item.num_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                            </tr>
                                                            <tr ng-if="!snvsMnvsIndelsGridOptions.data || !snvsMnvsIndelsGridOptions.data.length" class="no-data-message">
                                                                <td colspan="13" class="text-muted">No exclusion CNVs</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                    </div>
                                </uib-tab>

                                <uib-tab heading="CNVs">
                                    <div class="panel-body">
                                            <div id="cnvs" grid-data grid-options="cnvsGridOptions" grid-actions="gridActions" class="data-grid">
                                                <div class="row">
                                                    <div class="col pull-left">
                                                        <form class="form-inline">
                                                            <div class="form-group">
                                                                <div class="items-per-page">
                                                                    <label for="itemsOnPageSelectCnv">Show</label>
                                                                    <select id="itemsOnPageSelectCnv" class="form-control input-sm" ng-init="paginationOptions.itemsPerPage = '10'" ng-model="paginationOptions.itemsPerPage"
                                                                            ng-change="reloadGrid()">
                                                                        <option>10</option>
                                                                        <option>25</option>
                                                                        <option>50</option>
                                                                        <option>100</option>
                                                                    </select>
                                                                    <label for="itemsOnPageSelectCnv">per page</label>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                    <div class="col pull-right">
                                                        <div class="grid-filter">
                                                            <input type="text" class="form-control input-sm order-search-box" placeholder="Filter by all columns" grid-id="cnvs"
                                                                   ng-change="gridActions.filter()" ng-model="filterAll" filter-by="filterAll" filter-type="text">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="btn-group">
                                                    <div class="btn-group btn-group-margin" data-toggle="buttons">
                                                        <label class="btn btn-outline btn-success" ng-class="getInExclusionTypeClass('inclusion')" ng-click="setInExclusionType('inclusion')"
                                                               title="Switch to Inclusion">
                                                            <input type="radio" name="inExclusionType" id="option1">INCLUSION
                                                        </label>
                                                        <label class="btn btn-outline btn-success" ng-class="getInExclusionTypeClass('exclusion')" ng-click="setInExclusionType('exclusion')"
                                                               title="Switch to Exclusion">
                                                            <input type="radio" name="inExclusionType" id="option2">EXCLUSION
                                                        </label>
                                                    </div>
                                                </div>
                                                <br><br>
                                                <div class="row" ng-if="inExclusionType === 'inclusion'">
                                                    <table class="table table-striped">
                                                        <thead>
                                                            <tr>
                                                                <th sortable="gene" class="sortable">Gene</th>
                                                                <th sortable="chromosome" class="sortable">Chrom <i class="fa fa-question-circle" data-placement="top"
                                                                                                                    title="{{tooltipContent.chr}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="position" class="sortable">Position</th>
                                                                <th sortable="level_of_evidence" class="sortable">LOE <i class="fa fa-question-circle" data-placement="top"
                                                                                                                         title="{{tooltipContent.loe}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th class="text-center">Lit <i class="fa fa-question-circle" data-placement="top"
                                                                                               title="{{tooltipContent.lit}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="num_patients_with_variant" class="sortable">Total # Of Patients With Copy Number</th>
                                                                <th sortable="num_patients_with_variant_on_arm" class="sortable">Patients With This Copy Number Who Were Assigned To This Arm</th>
                                                                <th sortable="percent_patients_with_variant_on_arm" class="sortable">% Of Patients With Variant On Arm Of Total Patients With
                                                                    Variant
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr grid-item ng-model="version">
                                                                <td><a ng-click="openId(item.identifier)"><span ng-bind="item.identifier | dashify"></span></a></td>
                                                                <td ng-bind="item.chromosome | dashify"></td>
                                                                <td ng-bind="item.position | dashify"></td>
                                                                <td ng-bind="item.cds_reference | dashify"></td>
                                                                <td ng-bind="item.cds_alternative | dashify"></td>
                                                                <td ng-bind="item.ocp_reference | dashify"></td>
                                                                <td ng-bind="item.ocp_alternative | dashify"></td>
                                                                <td ng-bind="item.strand | dashify"></td>
                                                                <td ng-bind="item.level_of_evidence | dashify"></td>
                                                                <td>
                                                                    <table>
                                                                        <tr ng-repeat="subitem in item.public_med_ids">
                                                                            <td><a ng-click="openPubMed(subitem)">{{subitem | dashify }}</a></td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                                <td ng-bind="item.num_patients_with_variant | dashify" style="text-align:right"></td>
                                                                <td ng-bind="item.num_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                                <td ng-bind="item.percent_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                            </tr>
                                                            <tr ng-if="!cnvsGridOptions.data || !cnvsGridOptions.data.length" class="no-data-message">
                                                                <td colspan="13" class="text-muted">No inclusion CNVs</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <form class="form-inline pull-left">
                                                        <div class="form-group">
                                                            <grid-pagination max-size="5" class="pagination-sm" total-items="paginationOptions.totalItems" ng-model="paginationOptions.currentPage"
                                                                             ng-change="reloadGrid()" items-per-page="paginationOptions.itemsPerPage"></grid-pagination>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="row" ng-if="inExclusionType === 'exclusion'">
                                                    <table class="table table-striped">
                                                        <thead>
                                                            <tr>
                                                                <th sortable="gene" class="sortable">Gene</th>
                                                                <th sortable="chromosome" class="sortable">Chrom <i class="fa fa-question-circle" data-placement="top"
                                                                                                                    title="{{tooltipContent.chr}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="position" class="sortable">Position</th>
                                                                <th sortable="level_of_evidence" class="sortable">LOE <i class="fa fa-question-circle" data-placement="top"
                                                                                                                         title="{{tooltipContent.loe}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th class="text-center">Lit <i class="fa fa-question-circle" data-placement="top"
                                                                                               title="{{tooltipContent.lit}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th sortable="num_patients_with_variant" class="sortable">Total # Of Patients With Copy Number</th>
                                                                <th sortable="num_patients_with_variant_on_arm" class="sortable">Patients With This Copy Number Who Were Excluded From This Arm</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr grid-item ng-model="version">
                                                                <td><a ng-click="openId(item.identifier)"><span ng-bind="item.identifier | dashify"></span></a></td>
                                                                <td ng-bind="item.chromosome | dashify"></td>
                                                                <td ng-bind="item.position | dashify"></td>
                                                                <td ng-bind="item.cds_reference | dashify"></td>
                                                                <td ng-bind="item.cds_alternative | dashify"></td>
                                                                <td ng-bind="item.ocp_reference | dashify"></td>
                                                                <td ng-bind="item.ocp_alternative | dashify"></td>
                                                                <td ng-bind="item.strand | dashify"></td>
                                                                <td ng-bind="item.level_of_evidence | dashify"></td>
                                                                <td>
                                                                    <table>
                                                                        <tr ng-repeat="subitem in item.public_med_ids">
                                                                            <td><a ng-click="openPubMed(subitem)">{{subitem | dashify }}</a></td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                                <td ng-bind="item.num_patients_with_variant | dashify" style="text-align:right"></td>
                                                                <td ng-bind="item.num_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                            </tr>
                                                            <tr ng-if="!cnvsGridOptions.data || !cnvsGridOptions.data.length" class="no-data-message">
                                                                <td colspan="13" class="text-muted">No exclusion CNVs</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <form class="form-inline pull-left">
                                                        <div class="form-group">
                                                            <grid-pagination max-size="5" class="pagination-sm" total-items="paginationOptions.totalItems" ng-model="paginationOptions.currentPage"
                                                                             ng-change="reloadGrid()" items-per-page="paginationOptions.itemsPerPage"></grid-pagination>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                    </div>
                                </uib-tab>

                                <uib-tab heading="Gene Fusions">
                                    <div class="panel-body">
                                        <div id="geneFusions" grid-data grid-options="geneFusionsGridOptions" grid-actions="gridActions" class="data-grid">
                                            <div class="row">
                                                <div class="col pull-left">
                                                    <form class="form-inline">
                                                        <div class="form-group">
                                                            <div class="items-per-page">
                                                                <label for="itemsOnPageSelectGeneFusion">Show</label>
                                                                <select id="itemsOnPageSelectGeneFusion" class="form-control input-sm" ng-init="paginationOptions.itemsPerPage = '10'" ng-model="paginationOptions.itemsPerPage"
                                                                        ng-change="reloadGrid()">
                                                                    <option>10</option>
                                                                    <option>25</option>
                                                                    <option>50</option>
                                                                    <option>100</option>
                                                                </select>
                                                                <label for="itemsOnPageSelectGeneFusion">per page</label>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="col pull-right">
                                                    <div class="grid-filter">
                                                        <input type="text" class="form-control input-sm order-search-box" placeholder="Filter by all columns" grid-id="snvsMnvsIndels"
                                                               ng-change="gridActions.filter()" ng-model="filterAll" filter-by="filterAll" filter-type="text">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="btn-group">
                                                <div class="btn-group btn-group-margin" data-toggle="buttons">
                                                    <label class="btn btn-outline btn-success" ng-class="getInExclusionTypeClass('inclusion')" ng-click="setInExclusionType('inclusion')"
                                                           title="Switch to Inclusion">
                                                        <input type="radio" name="inExclusionType" id="option1">INCLUSION
                                                    </label>
                                                    <label class="btn btn-outline btn-success" ng-class="getInExclusionTypeClass('exclusion')" ng-click="setInExclusionType('exclusion')"
                                                           title="Switch to Exclusion">
                                                        <input type="radio" name="inExclusionType" id="option2">EXCLUSION
                                                    </label>
                                                </div>
                                            </div>
                                            <br><br>
                                            <div class="row" ng-if="inExclusionType === 'inclusion'">
                                                <table class="table table-striped">
                                                    <thead>
                                                    <tr>
                                                        <th sortable="identifier" class="sortable">ID</th>
                                                        <th sortable="level_of_evidence" class="sortable">LOE <i class="fa fa-question-circle" data-placement="top"
                                                                                                                 title="{{tooltipContent.loe}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                        <th class="text-center">Lit <i class="fa fa-question-circle" data-placement="top"
                                                                                       title="{{tooltipContent.lit}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                        <th sortable="num_patients_with_variant" class="sortable">Total # Of Patients With Gene Fusion</th>
                                                        <th sortable="num_patients_with_variant_on_arm" class="sortable">Patients With This Gene Fusion Who Were Assigned To This Arm</th>
                                                        <th sortable="percent_patients_with_variant_on_arm" class="sortable">% Of Patients With Variant On Arm Of Total Patients With
                                                            Gene Fusion
                                                        </th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr grid-item ng-model="version">
                                                            <td><a ng-click="openId(item.identifier)"><span ng-bind="item.identifier | dashify"></span></a></td>
                                                            <td ng-bind="item.level_of_evidence | dashify"></td>
                                                            <td>
                                                                <table>
                                                                    <tr ng-repeat="subitem in item.public_med_ids">
                                                                        <td><a ng-click="openPubMed(subitem)">{{subitem | dashify }}</a></td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                            <td ng-bind="item.num_patients_with_variant | dashify" style="text-align:right"></td>
                                                            <td ng-bind="item.num_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                            <td ng-bind="item.percent_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                        </tr>
                                                        <tr ng-if="!geneFusionsGridOptions.data || !geneFusionsGridOptions.data.length" class="no-data-message">
                                                            <td colspan="13" class="text-muted">No inclusion Gene Fusions</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <form class="form-inline pull-left">
                                                    <div class="form-group">
                                                        <grid-pagination max-size="5" class="pagination-sm" total-items="paginationOptions.totalItems" ng-model="paginationOptions.currentPage"
                                                                         ng-change="reloadGrid()" items-per-page="paginationOptions.itemsPerPage"></grid-pagination>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="row" ng-if="inExclusionType === 'exclusion'">
                                                <table class="table table-striped">
                                                    <thead>
                                                    <tr>
                                                        <th sortable="identifier" class="sortable">ID</th>
                                                        <th class="text-center">Lit <i class="fa fa-question-circle" data-placement="top"
                                                                                       title="{{tooltipContent.lit}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                        <th sortable="num_patients_with_variant" class="sortable">Total # Of Patients With Gene Fusion</th>
                                                        <th sortable="num_patients_with_variant_on_arm" class="sortable">Patients With This Gene Fusion Who Were Excluded From This Arm</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr grid-item ng-model="version">
                                                        <td><a ng-click="openId(item.identifier)"><span ng-bind="item.identifier | dashify"></span></a></td>
                                                        <td>
                                                            <table>
                                                                <tr ng-repeat="subitem in item.public_med_ids">
                                                                    <td><a ng-click="openPubMed(subitem)">{{subitem | dashify }}</a></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                        <td ng-bind="item.num_patients_with_variant | dashify" style="text-align:right"></td>
                                                        <td ng-bind="item.num_patients_with_variant_on_arm | dashify" style="text-align:right"></td>
                                                    </tr>
                                                    <tr ng-if="!geneFusionsGridOptions.data || !geneFusionsGridOptions.data.length" class="no-data-message">
                                                        <td colspan="13" class="text-muted">No exclusion Gene Fusions</td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </uib-tab>

                                <uib-tab heading="Non-Hotspot Rules">
                                    <div class="panel-body">
                                        <div class="ibox float-e-margins">
                                            <div class="ibox-content" style="border-top-width: 0px">
                                                <div class="btn-group btn-group-margin" data-toggle="buttons">
                                                    <label class="btn btn-outline btn-success" ng-class="getInExclusionTypeClass('inclusion')" ng-click="setInExclusionType('inclusion')"
                                                        title="Switch to Inclusion">
                                                    <input type="radio" name="inExclusionType" id="option1">INCLUSION
                                                </label>
                                                    <label class="btn btn-outline btn-success" ng-class="getInExclusionTypeClass('exclusion')" ng-click="setInExclusionType('exclusion')"
                                                        title="Switch to Exclusion">
                                                    <input type="radio" name="inExclusionType" id="option2">EXCLUSION
                                                </label>
                                                </div>
                                                <br><br>
                                                <div class="row" ng-if="inExclusionType == 'inclusion'">
                                                    <table datatable="ng" dt-options="dtOptions" class="table table-striped table-bordered table-hover" style="width:100%">
                                                        <thead>
                                                            <tr>
                                                                <th>Gene</th>
                                                                <th>Exon</th>
                                                                <th>Oncomine Variant Class</th>
                                                                <th>Function</th>
                                                                <th>LOE <i class="fa fa-question-circle" data-placement="top"
                                                                        title="{{tooltipContent.loe}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th>Lit <i class="fa fa-question-circle" data-placement="top"
                                                                        title="{{tooltipContent.lit}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th>Total # Patients With Gene</th>
                                                                <th>Patients With This Gene Who Were Assigned To This Arm</th>
                                                                <th>% Of Patients With Gene On Arm Of Total Patients With Gene
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr ng-repeat="item in currentVersion.nhrsInclusion">
                                                                <td><a ng-click="openGene(item.func_gene)">{{item.func_gene | dashify }}</a></td>
                                                                <td>{{item.exon | dashify }}</td>
                                                                <td>{{item.oncomine_variant_class | dashify }}</td>
                                                                <td>{{item.function | dashify }}</td>
                                                                <td>{{item.level_of_evidence | dashify }}</td>
                                                                <td>
                                                                    <div ng-repeat="subitem in item.public_med_ids">
                                                                        <a ng-click="openPubMed(subitem)">{{subitem | dashify }}</a>
                                                                    </div>                                                                                                                                        
                                                                </td>
                                                                <td style="text-align:right">{{item.num_patients_with_variant | dashify }}</td>
                                                                <td style="text-align:right">{{item.num_patients_with_variant_on_arm | dashify }}</td>
                                                                <td style="text-align:right">{{item.percent_patients_with_variant_on_arm | dashify }}
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="row" ng-if="inExclusionType == 'exclusion'">
                                                    <table datatable="ng" dt-options="dtOptions" class="table table-striped table-bordered table-hover" style="width:100%">
                                                        <thead>
                                                            <tr>
                                                                <th>Gene</th>
                                                                <th>Exon</th>
                                                                <th>Oncomine Variant Class</th>
                                                                <th>Function</th>
                                                                <th>Lit <i class="fa fa-question-circle" data-placement="top" title="{{tooltipContent.lit}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th>Total # Patients With Gene</th>
                                                                <th>Patients With This Gene Who Were Excluded From This Arm</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr ng-repeat="item in currentVersion.nhrsExclusion">
                                                                <td><a ng-click="openGene(item.func_gene)">{{item.func_gene | dashify }}</a></td>
                                                                <td>{{item.exon | dashify }}</td>
                                                                <td>{{item.oncomine_variant_class | dashify }}</td>
                                                                <td>{{item.function | dashify }}</td>
                                                                <td>
                                                                    <div ng-repeat="subitem in item.public_med_ids">
                                                                        <a ng-click="openPubMed(subitem)">{{subitem | dashify }}</a>
                                                                    </div>                                                                                                                                        
                                                                </td>
                                                                <td style="text-align:right">{{item.num_patients_with_variant | dashify }}</td>
                                                                <td style="text-align:right">{{item.num_patients_with_variant_on_arm | dashify }}</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </uib-tab>

                                <uib-tab heading="Non-Sequencing Assays">
                                    <div class="panel-body">
                                        <div class="ibox float-e-margins">
                                            <div class="ibox-content" style="border-top-width: 0px">
                                                <div class="row">
                                                    <table datatable="ng" dt-options="dtOptions" class="table table-striped table-bordered table-hover" style="width:100%">
                                                        <thead>
                                                            <tr>
                                                                <th>Gene</th>
                                                                <th>Result</th>
                                                                <th>Variant Association</th>
                                                                <th>LOE <i class="fa fa-question-circle" data-placement="top"
                                                                        title="{{tooltipContent.loe}}" onmouseenter="$(this).tooltip('show')"></i></th>
                                                                <th>Total # Patients With Variant</th>
                                                                <th>Patients With This Variant Who Were Assigned To This Arm
                                                                </th>
                                                                <th>% Of Patients With Variant On Arm Of Total Patients With
                                                                    Variant
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr ng-repeat="item in currentVersion.assay_results">
                                                                <td><a ng-click="openGene(item.func_gene)">{{item.func_gene | dashify }}</a></td>
                                                                <td>{{item.assay_result_status | dashify }}</td>
                                                                <td>{{item.assay_variant | dashify }}</td>
                                                                <td>{{item.level_of_evidence | dashify }}</td>
                                                                <td style="text-align:right">{{item.num_patients_with_gene | dashify }}</td>
                                                                <td style="text-align:right">{{item.num_patients_with_gene_on_arm | dashify }}</td>
                                                                <td style="text-align:right">{{item.percent_patients_with_gene_on_arm | dashify }}</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </uib-tab>
                            </uib-tabset>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab heading="History">
                    <div class="panel-body">
                        <div class="ibox-title ibox-title-no-line-no-padding">
                            <h3>Version History</h3>
                        </div>

                        <table class="table" role="grid">
                            <thead>
                                <tr>
                                    <th width="20%" class="label2">Version</th>
                                    <th width="40%" class="label2">Status</th>
                                    <th width="40%" class="label2">Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="version in versionHistory" style="cursor: auto;" role="row" class="odd">
                                    <td>{{version.version | dashify}}</td>
                                    <td>
                                        <span ng-style="{'color':'{{ version.status | taStatus }}'}">{{version.status | dashify}}</span>
                                    </td>
                                    <td>{{version.date | utc | dashify}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </uib-tab>
            </uib-tabset>
        </div>
    </div>
</div>