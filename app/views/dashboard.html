<div ng-controller="DashboardController">

    <div class="row border-bottom white-bg dashboard-header animated fadeInRight">
        <h2 class="welcome">Welcome, {{ name }}!</h2>

        <div class="col-sm-3" ng-init="loadDashboardData()">
            <!-- loadPatientPendingAssignmentReportsList() -->
            <div>
                <h3>Patients Statistics</h3>
            </div>

            <!--<div class="header-info-box">
                <dl class="dl-horizontal">
                    <dt>Number of Registered Patients</dt>
                    <dd>{{ numberOfPatients }}</dd>

                    <dt>Number of Patients with Confirmed Variant Report</dt>
                    <dd>{{ numberOfScreenedPatients }}</dd>

                    <dt>Pending Tissue Variant Reports</dt>
                    <dd>{{ pendingTissueVariantReportList.length }}</dd>

                    <dt>Pending Blood Variant Reports</dt>
                    <dd>{{ pendingBloodVariantReportList.length }}</dd>

                    <dt>Pending Assignment Reports</dt>
                    <dd>{{ pendingAssignmentReportList.length }}</dd>
                </dl>
            </div>-->

            <div class="statistic-box dashboard">
                <ul class="list-group clear-list statistics m-t">
                    <li class="list-group-item fist-item no-border">
                        <span class="pull-right">{{ numberOfPatients }}</span>
                        <!--<span class="label label-info"><i class="fa fa-group"></i></span>-->
                        Registered Patients
                    </li>
                    <li class="list-group-item no-border">
                        <span class="pull-right">{{ numberOfScreenedPatients }}</span>
                        <!--<span class="label label-info"><i class="fa fa-group"></i></span>-->
                        Patients with Confirmed Variant Report
                    </li>
                    <li class="list-group-item">
                        <span class="pull-right">{{ numberOfPatientsWithTreatment }}</span>
                        <!--<span class="label label-success"><i class="fa fa-medkit"></i></span>-->
                        Patients on Treatment
                    </li>
                    <li class="list-group-item">
                        <span class="pull-right">{{ pendingTissueVariantReportList.length }}</span>
                        <!--<span class="label label-warning"><i class="fa fa-newspaper-o"></i></span>-->
                        Pending Tissue Variant Reports
                    </li>
                    <li class="list-group-item">
                        <span class="pull-right">{{ pendingBloodVariantReportList.length }}</span>
                        <!--<span class="label label-warning"><i class="fa fa-newspaper-o"></i></span>-->
                        Pending Blood Variant Reports
                    </li>
                    <li class="list-group-item">
                        <span class="pull-right">{{ pendingAssignmentReportList.length }}</span>
                        <!--<span class="label label-warning"><i class="fa fa-newspaper-o"></i></span>-->
                        Pending Assignment Reports
                    </li>
                </ul>
            </div>
        </div>

        <div class="col-sm-6" ng-init="setCanvasHeight('#treatmentArmAccrualCanvas', 95);loadTreatmentArmAccrualData();">
            <div class="text-center">
                <h3>Top 5 Treatment Arm Accrual</h3>
            </div>
            <div id="chartBox" class="statistic-box dashboard">
                <canvas id="treatmentArmAccrualCanvas" barchart options="barOptions" ng-attr-data="barData" responsive="true"></canvas>
            </div>
        </div>

        <div class="col-sm-3" ng-init="setCanvasHeight('#amoiCanvas', 95);loadChartjsDonutChartData();">
            <div class="text-center">
                <h3>Sequenced & Confirmed Patients with aMOI(s)</h3>
            </div>
            <div class="statistic-box dashboard">
                <canvas id="amoiCanvas" doughnutchart options="donutOptions" ng-attr-data="donutData" legend="true" responsive="true"></canvas>
                <!--  legend="true" -->
            </div>
        </div>

    </div>

    <div class="wrapper wrapper-dashboard">
        <div vertilize-container class="row">
            <div vertilize class="col-lg-3 col-md-4 col-sm-5">

                <div class="ibox-title ibox-title-no-line" id="activity-column">
                    <h3>Activity Feed</h3>
                </div>

                <div class="ibox-content inspinia-timeline" ng-controller="ActivityController as activity" ng-init="activity.loadData()"
                    id="panding-items-column">
                    <div class="timeline-item" ng-repeat="timelineEvent in activity.data">
                        <patient-timeline timeline-event="timelineEvent" type="timelineEvent.event_type" layout="'narrow'"></patient-timeline>
                    </div>
                </div>
            </div>

            <div class="col-lg-9 col-md-8 col-sm-7">
                <div vertilize class="panel-container">
                    <div class="ibox-title ibox-title-no-line">
                        <h3>Pending Review </h3>
                    </div>
                    <div class="tabs-container">
                        <uib-tabset>
                            <uib-tab heading="Tissue Variant Reports">
                                <div class="panel-body" ng-init="loadTissueVariantReportsList()">
                                    <table datatable="ng" dt-options="DashCtrl.ddOptions" dt-column-defs="DashCtrl.dtColumnDefs" dt-instance="DashCtrl.dtInstance"
                                        class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th>Patient ID</th>
                                                <th>Molecular ID</th>
                                                <th>Analysis ID</th>
                                                <th class="text-center">Variant Report</th>
                                                <th>CLIA Lab</th>
                                                <th>Specimen Received Date</th>
                                                <th>Variant Report Received Date</th>
                                                <th>Days Pending</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="patient in pendingTissueVariantReportList">
                                                <td>
                                                    <a ui-sref="patient({ patient_id: patient.patient_id })">
                                                        <i class="fa fa-user"></i> {{::patient.patient_id | dashify }}
                                                    </a>
                                                </td>
                                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'surgical_event', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.molecular_id | dashify }}</a></td>
                                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'tissue_variant_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.analysis_id | dashify }}</a></td>
                                                <td class="text-center">
                                                    <a ui-sref="patient({ patient_id: patient.patient_id, section: 'tissue_variant_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })"
                                                        title="Variant Report">
                                                        <i class="fa fa-file-text-o"></i>
                                                    </a>
                                                </td>
                                                <td ng-if="patient.clia_lab === 'MoCha'">
                                                    <a ui-sref="clia-labs" ng-click="clialab('mocha')">{{ patient.clia_lab | dashify }}</a>
                                                </td>
                                                <td ng-if="patient.clia_lab === 'MDA'">
                                                    <a ui-sref="clia-labs" ng-click="clialab('mdacc')">{{ patient.clia_lab | dashify }}</a>
                                                </td>
                                                <td>{{ patient.specimen_received_date | gmt }}</td>
                                                <td>{{ patient.variant_report_received_date | gmt }}</td>
                                                <td><span ng-if="patient.days_pending >= days_pending_range.upper_bound_yellow"
                                                        class="label label-danger">{{ patient.days_pending | dashify }}</span>
                                                    <span ng-if="patient.days_pending < days_pending_range.upper_bound_yellow && patient.days_pending >= days_pending_range.upper_bound_green"
                                                        class="label label-warning">{{ patient.days_pending | dashify }}</span>
                                                    <span ng-if="patient.days_pending < days_pending_range.upper_bound_green" class="label label-primary">{{ patient.days_pending | dashify }}</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </uib-tab>
                            <uib-tab heading="Blood Variant Reports">
                                <div class="panel-body" ng-init="loadBloodVariantReportsList()">
                                    <table datatable="ng" dt-options="DashCtrl.ddOptions" dt-column-defs="DashCtrl.dtColumnDefs" dt-instance="DashCtrl.dtInstance"
                                        class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th>Patient ID</th>
                                                <th>Molecular ID</th>
                                                <th>Analysis ID</th>
                                                <th class="text-center">Variant Report</th>
                                                <th>CLIA Lab</th>
                                                <th>Specimen Received Date</th>
                                                <th>Variant Report Received Date</th>
                                                <th>Days Pending</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="patient in pendingBloodVariantReportList">
                                                <td>
                                                    <a ui-sref="patient({ patient_id: patient.patient_id })">
                                                        <i class="fa fa-user"></i> {{::patient.patient_id | dashify }}
                                                    </a>
                                                </td>
                                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'surgical_event', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.molecular_id | dashify }}</a></td>
                                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'blood_variant_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.analysis_id | dashify }}</a></td>
                                                <td class="text-center">
                                                    <a ui-sref="patient({ patient_id: patient.patient_id, section: 'blood_variant_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })"
                                                        title="Variant Report">
                                                        <i class="fa fa-file-text-o"></i>
                                                    </a>
                                                </td>
                                                <td ng-if="patient.clia_lab === 'MoCha'">
                                                    <a ui-sref="clia-labs" ng-click="clialab('mocha')">{{ patient.clia_lab | dashify }}</a>
                                                </td>
                                                <td ng-if="patient.clia_lab === 'MDA'">
                                                    <a ui-sref="clia-labs" ng-click="clialab('mdacc')">{{ patient.clia_lab | dashify }}</a>
                                                </td>
                                                <td>{{ patient.specimen_received_date | gmt }}</td>
                                                <td>{{ patient.variant_report_received_date | gmt }}</td>
                                                <td><span ng-if="patient.days_pending >= days_pending_range.upper_bound_yellow"
                                                        class="label label-danger">{{ patient.days_pending | dashify }}</span>
                                                    <span ng-if="patient.days_pending < days_pending_range.upper_bound_yellow && patient.days_pending >= days_pending_range.upper_bound_green"
                                                        class="label label-warning">{{ patient.days_pending | dashify }}</span>
                                                    <span ng-if="patient.days_pending < days_pending_range.upper_bound_green" class="label label-primary">{{ patient.days_pending | dashify }}</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </uib-tab>
                            <uib-tab heading="Assignment Reports">
                                <div class="panel-body" ng-init="loadPatientPendingAssignmentReportsList()">
                                    <table datatable="ng" dt-options="DashCtrl.ddOptions" dt-column-defs="DashCtrl.dtColumnDefs" dt-instance="DashCtrl.dtInstance"
                                        class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th>Patient ID</th>
                                                <th>Molecular ID</th>
                                                <th>Analysis ID</th>
                                                <th class="text-center">Assignment Report</th>
                                                <th>Disease</th>
                                                <th>Assigned Treatment Arm</th>
                                                <th>Assignment Date</th>
                                                <th>Hours Pending</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="patient in pendingAssignmentReportList">
                                                <td>
                                                    <a ui-sref="patient({ patient_id: patient.patient_id })">
                                                        <i class="fa fa-user"></i> {{::patient.patient_id }}
                                                    </a>
                                                </td>
                                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'surgical_event', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.molecular_id | dashify }}</a></td>
                                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'assignment_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.analysis_id | dashify }}</a></td>
                                                <td class="text-center">
                                                    <a ui-sref="patient({ patient_id: patient.patient_id, section: 'assignment_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })"
                                                        title="Assignment Report">
                                                        <i class="fa fa-file-text-o"></i>
                                                    </a>
                                                </td>
                                                <td>{{patient.disease | dashify }}</td>
                                                <td>
                                                    <treatment-arm-title name="patient.treatment_arm" stratum="patient.treatment_arm_stratum_id" version="patient.treatment_arm_version"></treatment-arm-title>
                                                </td>
                                                <td>{{ patient.assignment_date | gmt }}</td>
                                                <td><span ng-if="patient.hours_pending >= hours_pending_range.upper_bound_yellow"
                                                        class="label label-danger">{{ patient.hours_pending | dashify }}</span>
                                                    <span ng-if="patient.hours_pending < hours_pending_range.upper_bound_yellow && patient.hours_pending >= hours_pending_range.upper_bound_green"
                                                        class="label label-warning">{{ patient.hours_pending | dashify }}</span>
                                                    <span ng-if="patient.hours_pending < hours_pending_range.upper_bound_green" class="label label-primary">{{ patient.hours_pending | dashify }}</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </uib-tab>
                        </uib-tabset>
                    </div>
                </div>
            </div>


            <!--<div class="col-lg-9 col-md-8 col-sm-7">
                <div class="ibox-title ibox-title-no-line">
                    <h3>Pending Review </h3>
                </div>

                <div class="ibox-content">
                    <table ng-init="loadTissueVariantReportsList()" datatable="ng" dt-options="DashCtrl.ddOptions" dt-column-defs="DashCtrl.dtColumnDefs"
                        dt-instance="DashCtrl.dtInstance" class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Patient ID</th>
                                <th>Molecular ID</th>
                                <th>Analysis ID</th>
                                <th class="text-center">Variant Report</th>
                                <th>CLIA Lab</th>
                                <th>Specimen Received Date</th>
                                <th>Variant Report Received Date</th>
                                <th>Days Pending</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="patient in pendingTissueVariantReportList">
                                <td>
                                    <a ui-sref="patient({ patient_id: patient.patient_id })">
                                        <i class="fa fa-user"></i> {{::patient.patient_id | dashify }}
                                    </a>
                                </td>
                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'surgical_event', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.molecular_id | dashify }}</a></td>
                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'tissue_variant_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.analysis_id | dashify }}</a></td>
                                <td class="text-center">
                                    <a ui-sref="patient({ patient_id: patient.patient_id, section: 'tissue_variant_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })"
                                        title="Variant Report">
                                        <i class="fa fa-file-text-o"></i>
                                    </a>
                                </td>
                                <td ng-if="patient.clia_lab === 'MoCha'">
                                    <a ui-sref="iradmin({branch: 'mocha'})">{{ patient.clia_lab | dashify }}</a>
                                </td>
                                <td ng-if="patient.clia_lab === 'MDA'">
                                    <a ui-sref="iradmin({branch: 'mdacc'})">{{ patient.clia_lab | dashify }}</a>
                                </td>
                                <td>{{ patient.specimen_received_date | gmt }}</td>
                                <td>{{ patient.variant_report_received_date | gmt }}</td>
                                <td><span ng-if="patient.days_pending >= days_pending_range.upper_bound_yellow" class="label label-danger">{{ patient.days_pending | dashify }}</span>
                                    <span ng-if="patient.days_pending < days_pending_range.upper_bound_yellow && patient.days_pending >= days_pending_range.upper_bound_green"
                                        class="label label-warning">{{ patient.days_pending | dashify }}</span>
                                    <span ng-if="patient.days_pending < days_pending_range.upper_bound_green" class="label label-primary">{{ patient.days_pending | dashify }}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <table ng-init="loadBloodVariantReportsList()" datatable="ng" dt-options="DashCtrl.ddOptions" dt-column-defs="DashCtrl.dtColumnDefs"
                        dt-instance="DashCtrl.dtInstance" class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Patient ID</th>
                                <th>Molecular ID</th>
                                <th>Analysis ID</th>
                                <th class="text-center">Variant Report</th>
                                <th>CLIA Lab</th>
                                <th>Specimen Received Date</th>
                                <th>Variant Report Received Date</th>
                                <th>Days Pending</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="patient in pendingBloodVariantReportList">
                                <td>
                                    <a ui-sref="patient({ patient_id: patient.patient_id })">
                                        <i class="fa fa-user"></i> {{::patient.patient_id | dashify }}
                                    </a>
                                </td>
                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'surgical_event', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.molecular_id | dashify }}</a></td>
                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'blood_variant_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.analysis_id | dashify }}</a></td>
                                <td class="text-center">
                                    <a ui-sref="patient({ patient_id: patient.patient_id, section: 'blood_variant_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })"
                                        title="Variant Report">
                                        <i class="fa fa-file-text-o"></i>
                                    </a>
                                </td>
                                <td ng-if="patient.clia_lab === 'MoCha'">
                                    <a ui-sref="iradmin({branch: 'mocha'})">{{ patient.clia_lab | dashify }}</a>
                                </td>
                                <td ng-if="patient.clia_lab === 'MDA'">
                                    <a ui-sref="iradmin({branch: 'mdacc'})">{{ patient.clia_lab | dashify }}</a>
                                </td>
                                <td>{{ patient.specimen_received_date | gmt }}</td>
                                <td>{{ patient.variant_report_received_date | gmt }}</td>
                                <td><span ng-if="patient.days_pending >= days_pending_range.upper_bound_yellow" class="label label-danger">{{ patient.days_pending | dashify }}</span>
                                    <span ng-if="patient.days_pending < days_pending_range.upper_bound_yellow && patient.days_pending >= days_pending_range.upper_bound_green"
                                        class="label label-warning">{{ patient.days_pending | dashify }}</span>
                                    <span ng-if="patient.days_pending < days_pending_range.upper_bound_green" class="label label-primary">{{ patient.days_pending | dashify }}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <table ng-init="loadPatientPendingAssignmentReportsList()" datatable="ng" dt-options="DashCtrl.ddOptions" dt-column-defs="DashCtrl.dtColumnDefs"
                        dt-instance="DashCtrl.dtInstance" class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Patient ID</th>
                                <th>Molecular ID</th>
                                <th>Analysis ID</th>
                                <th class="text-center">Assignment Report</th>
                                <th>Disease</th>
                                <th>Assigned Treatment Arm</th>
                                <th>Assignment Date</th>
                                <th>Hours Pending</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="patient in pendingAssignmentReportList">
                                <td>
                                    <a ui-sref="patient({ patient_id: patient.patient_id })">
                                        <i class="fa fa-user"></i> {{::patient.patient_id }}
                                    </a>
                                </td>
                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'surgical_event', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.molecular_id | dashify }}</a></td>
                                <td><a ui-sref="patient({ patient_id: patient.patient_id, section: 'assignment_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })">{{ patient.analysis_id | dashify }}</a></td>
                                <td class="text-center">
                                    <a ui-sref="patient({ patient_id: patient.patient_id, section: 'assignment_report', molecular_id: patient.molecular_id, analysis_id: patient.analysis_id })"
                                        title="Variant Report">
                                        <i class="fa fa-file-text-o"></i>
                                    </a>
                                </td>
                                <td>{{patient.disease | dashify }}</td>
                                <td><treatment-arm-title name="patient.treatment_arm" stratum="patient.stratum"></treatment-arm-title></td>
                                <td>{{ patient.assignment_date | gmt }}</td>
                                <td><span ng-if="patient.hours_pending >= hours_pending_range.upper_bound_yellow" class="label label-danger">{{ patient.hours_pending | dashify }}</span>
                                    <span ng-if="patient.hours_pending < hours_pending_range.upper_bound_yellow && patient.hours_pending >= hours_pending_range.upper_bound_green"
                                        class="label label-warning">{{ patient.hours_pending | dashify }}</span>
                                    <span ng-if="patient.hours_pending < hours_pending_range.upper_bound_green" class="label label-primary">{{ patient.hours_pending | dashify }}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
            </div>-->
        </div>
    </div>
</div>