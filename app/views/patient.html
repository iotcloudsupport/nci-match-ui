<div ng-controller="PatientController" ng-init="loadPatientData()">
    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-lg-10">
            <h2>Patient</h2>
            <ol class="breadcrumb">
                <li>
                    <a ui-sref="dashboard">Dashboard</a>
                </li>
                <li>
                    <a ui-sref="patients">Patients</a>
                </li>
                <li class="active">
                    <strong>Patient {{ ::data.patient_id }}</strong>
                </li>
            </ol>
        </div>
        <div class="col-lg-2 text-right">
            <div class="top-toolbar-buttons">
                <button class="btn btn-success btn-outline" title="Export Patient data to PDF"><i class="fa fa-file-pdf-o"></i>&nbsp;&nbsp;PDF</button>
            </div>
        </div>
    </div>

    <div class="wrapper">

        <div class="no-horizontal-padding header-box-container">
            <div class="row">
                <div class="col-lg-6 col-md-6">
                    <div class="header-info-box top-main-header-box">
                        <dl class="dl-horizontal">
                            <dt>Patient ID</dt>
                            <dd>{{data.patient_id | dashify }}</dd>

                            <dt>Patient</dt>
                            <dd>{{data.gender}}, {{data.ethnicity | dashify }}</dd>

                            <dt>Last Rejoin Scan Date</dt>
                            <dd>{{ data.last_rejoin_scan_date | utc  | dashify }}</dd>

                            <dt>Status</dt>
                            <dd style="color: {{ data.current_status | patientStatus }}">{{data.current_status | dashify }}</dd>

                            <dt> Current Step</dt>
                            <dd>{{data.current_step_number | dashify }}</dd>

                            <dt>Treatment Arm</dt>
                            <dd>
                                <treatment-arm-title name="currentTreatmentArm.name" stratum="currentTreatmentArm.stratum" version="currentTreatmentArm.version"></treatment-arm-title>
                            </dd>
                        </dl>
                    </div>
                </div>

                <div class="col-lg-6 col-md-6">
                    <div class="header-info-box top-main-header-box">
                        <dl class="dl-horizontal">
                            <dt>Disease Name</dt>
                            <dd>{{::disease.disease_name | dashify }}</dd>

                            <dt>Disease Code Type</dt>
                            <dd>{{::disease.disease_code_type | dashify }}</dd>

                            <dt>Disease Code</dt>
                            <dd>{{::disease.disease_code | dashify }}</dd>

                            <dt>Prior Drugs</dt>
                            <dd ng-if="data.prior_drugs"> <span ng-repeat="drug in data.prior_drugs">{{drug.drug_name}}{{$last?'':', '}}</span></dd>
                            <dd ng-if="!data.prior_drugs"> - </dd>

                        </dl>
                    </div>
                </div>
            </div>
        </div>

        <div class="tabs-container">
            <uib-tabset active="activeTabIndex">
                <uib-tab heading="Summary" select="setActiveTab('summary')">
                    <div class="panel-body" ng-init="loadActionItems()">

                        <div ng-if="actionItems && actionItems.length">
                            <div class="ibox-title ibox-title-no-line-no-padding">
                                <h3>Actions Needed</h3>
                            </div>
                            <action-items items="actionItems" patient-id="patient_id"></action-items>
                        </div>

                        <div ng-if="data.ta_history" class="ibox-title ibox-title-no-line-no-padding">
                            <h3>Treatment Arm History</h3>
                        </div>

                        <table ng-if="data.ta_history" class="table table-hover" role="grid">
                            <thead>
                            <tr>
                                <th width="20%">Treatment Arm</th>
                                <th width="10%">Step</th>
                                <th width="50%">Assignment Reason</th>
                                <th width="20%">Date Assigned</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="ta in data.ta_history" style="cursor: auto; " role="row" class="odd">
                                <td>
                                    <treatment-arm-title name="ta.name" stratum="ta.stratum" version="ta.version"></treatment-arm-title>
                                </td>
                                <td>{{ta.step | dashify }}</td>
                                <td>{{ta.assignment_reason | dashify }}</td>
                                <td>{{ta.assignment_date | utc}}</td>
                            </tr>
                            </tbody>
                        </table> 

                        <div ng-controller="ActivityController as activity" ng-init="activity.startLoading()">
                            <div class="ibox-title ibox-title-no-line-no-padding">
                                <h3>Patient Timeline</h3>
                                <small class="text-muted">Loaded at {{activity.lastUpdated}}</small>
                            </div>

                            <div class="ibox-content inspinia-timeline">
                                <div class="timeline-item" ng-repeat="timelineEvent in activity.data">
                                    <timeline timeline-event="timelineEvent" type="timelineEvent.event_type" show-step-delimiter="'true'"></timeline>
                                </div>
                            </div>
                        </div>

                    </div>
                </uib-tab>

                <uib-tab heading="Surgical Events" select="setActiveTab('surgical_event')">
                    <div class="panel-body">
                        <div ng-if="currentSurgicalEvent">

                            <div class="row content-select-list">
                                <div class="col-md-12">
                                    <h4>
                                        <div class="btn-group" uib-dropdown dropdown-append-to-body>
                                            <button id="btn-append-to-body" type="button" class="btn btn-success btn-outline" uib-dropdown-toggle>{{surgicalEventOption.text}}<span class="caret"></span></button>
                                            <ul class="dropdown-menu" uib-dropdown-menu role="menu">
                                                <li ng-repeat="item in surgicalEventOptions" role="menuitem"><a href ng-click="onSurgicalEventSelected(item)">{{item.text}}</a></li>
                                            </ul>
                                        </div>
                                    </h4>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="header-info-box biopsy-header-box">
                                        <h4>Event</h4>
                                        <dl class="dl-horizontal">
                                            <dt>Surgical Event ID</dt>
                                            <dd>{{currentSurgicalEvent.surgical_event_id | dashify }}</dd>

                                            <dt>Type</dt>
                                            <dd>{{currentSurgicalEvent.type | dashify }}</dd>

                                            <dt>Collection Date</dt>
                                            <dd>{{currentSurgicalEvent.collected_date | utc | dashify }}</dd>

                                            <dt>Received Date</dt>
                                            <dd>{{currentSurgicalEvent.received_date | utc | dashify }}</dd>

                                            <dt>Failure Date</dt>
                                            <dd>{{currentSurgicalEvent.failed_date | utc | dashify }}</dd>
                                        </dl>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="header-info-box biopsy-header-box">
                                        <h4>Pathology</h4>
                                        <dl class="dl-horizontal">
                                            <dt>Status</dt>
                                            <dd>{{currentSurgicalEvent.pathology_status | dashify }}</dd>

                                            <dt>Received Date</dt>
                                            <dd>{{currentSurgicalEvent.pathology_status_date | utc | dashify }}</dd>

                                            <dt>Comment</dt>
                                            <dd>{{currentSurgicalEvent.comments | dashify }}</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>

                            <div class="ibox-title ibox-title-no-line-no-padding">
                                <h3>Slide Shipments</h3>
                            </div>

                            <table class="table" role="grid">
                                <thead>
                                    <tr>
                                        <th width="20%" class="label2">Bar-Code</th>
                                        <th width="40%" class="label2">Carrier</th>
                                        <th width="20%" class="label2">Tracking Number</th>
                                        <th width="20%" class="label2">Date Shipped</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="slide in currentSurgicalEvent.slides" style="cursor: auto;" role="row" class="odd">
                                        <td>{{slide.slide_barcode | dashify }}</td>
                                        <td>{{slide.carrier | dashify }}</td>
                                        <td>
                                            <tracking-link carrier="'fedex'" tracking-number="slide.tracking_id"></tracking-link>
                                        </td>
                                        <td>{{slide.shipped_dttm | utc | dashify }}</td>
                                    </tr>
                                    <tr ng-if="!currentSurgicalEvent.slides || !currentSurgicalEvent.slides.length">
                                        <td colspan="4"><span class="text-muted">No slides shipped</span></td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="ibox-title ibox-title-no-line-no-padding">
                                <h3>Assay History</h3>
                            </div>

                            <table class="table" role="grid">
                                <thead>
                                    <tr>
                                        <th width="" class="label2">Assay</th>
                                        <th width="" class="label2">Gene</th>
                                        <th width="" class="label2">Ordered Date</th>
                                        <th width="" class="label2">Result Date</th>
                                        <th width="" class="label2">Result</th>
                                        <th width="" class="label2">Comments</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="assay in currentSurgicalEvent.assays" style="cursor: auto;" role="row" class="odd">
                                        <td>{{assay.biomarker | dashify }}</td>
                                        <td>{{assay.gene | dashify }}</td>
                                        <td>{{assay.rordered_date | utc | dashify }}</td>
                                        <td>{{assay.result_date | utc | dashify }}</td>
                                        <td>
                                            <span style="color:{{ assay.result | assayStatus }}">{{assay.result | dashify }}</span>
                                        </td>
                                        <td>{{assay.comments | dashify }}</td>
                                    </tr>
                                    <tr ng-if="!currentSurgicalEvent.assays || !currentSurgicalEvent.assays.length">
                                        <td colspan="3"><span class="text-muted">No assay history</span></td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="ibox-title ibox-title-no-line-no-padding">
                                <h3>Specimen History</h3>
                            </div>

                            <div class="ibox-content ibox-content-no-padding ibox-title-no-line-no-padding">
                                <table class="table table-hover" role="grid">
                                    <thead>
                                    <tr>
                                        <th width="20%">Molecular ID</th>
                                        <th width="15%">Type</th>
                                        <th width="15%">Site</th>
                                        <th width="10%">Tracking Number</th>
                                        <th width="5%">DNA Conc</th>
                                        <th width="5%">DNA Vol</th>
                                        <th width="15%">Reported Date</th>
                                        <th width="20%">Comments</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat-start="shipment in currentSurgicalEvent.specimen_shipments" style="cursor: auto;" role="row" class="odd">
                                        <td>{{shipment.molecular_id | dashify }}</td>
                                        <td>{{shipment.type | dashify }}</td>
                                        <td>{{shipment.site | dashify }}</td>
                                        <td>
                                            <tracking-link ng-if="shipment.tracking_number" carrier="'fedex'" tracking-number="shipment.tracking_number"></tracking-link>
                                            <p ng-if="!shipment.tracking_number"> - </p>
                                        </td>
                                        <td>{{shipment.dna_concordance | dashify }}</td>
                                        <td>{{shipment.dna_volume | dashify }}</td>
                                        <td>{{shipment.reported_date | utc | dashify }}</td>
                                        <td>
                                            <div class="text-truncate-200px"  data-placement="top" title="{{shipment.comments}}" onmouseenter="$(this).tooltip('show')" >{{shipment.comments | dashify }}</div>
                                        </td>
                                    </tr>
                                    <tr ng-repeat-end>
                                        <td colspan="8">
                                            <ul class="panel-list">
                                                <li ng-repeat="analysis in shipment.analyses" class="info-element">
                                                    <div class="row">
                                                        <div class="col-md-4 col-sm-6 text-left">
                                                            <dl class="dl-horizontal-narrow">
                                                                <dt>Analysis ID</dt>
                                                                <dd><a ng-click="navigateToTissueVariantReport(analysis.molecular_id, analysis.analysis_id)"> {{analysis.analysis_id | dashify }} </a></dd>

                                                                <dt>Status</dt>
                                                                <dd style="{color:{{ analysis.status | analysisStatus }}">{{analysis.status | titlecase}}
                                                                    <span ng-if="analysis.comment_user"> (user: {{analysis.comment_user}})</span>
                                                                </dd>

                                                                <dt ng-if="analysis.comment">Comment</dt>
                                                                <dd ng-if="analysis.comment">{{analysis.comment}}</dd>
                                                            </dl>
                                                        </div>
                                                        <div class="col-md-5 col-sm-6 text-left">
                                                            <dl class="dl-horizontal-narrow">
                                                                <dt>File Received Date</dt>
                                                                <dd>{{analysis.variant_report_received_date | utc}}</dd>

                                                                <dt ng-if="needToDisplayReportStatus(analysis)">{{analysis.status | titlecase}} Date</dt>
                                                                <dd ng-if="needToDisplayReportStatus(analysis)">{{analysis.status_date | utc}}</dd>
                                                            </dl>
                                                        </div>
                                                        <div class="col-md-3 text-right">
                                                            <div class="row">
                                                                <div class="col-md-12 text-right">
                                                                    <a href="{{currentTissueVariantReport.dna_bam_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(analysis.dna_bam_path_name)">DNA BAM</a>
                                                                    <a href="{{currentTissueVariantReport.dna_bai_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(analysis.dna_bai_path_name)">DNA BAI</a>
                                                                    <a href="{{currentTissueVariantReport.vcf_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(analysis.vcf_path_name)">VCF</a>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-md-12 text-right">
                                                                    <a href="{{currentTissueVariantReport.rna_bam_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(analysis.rna_bam_path_name)">cDNA BAM</a>
                                                                    <a href="{{currentTissueVariantReport.rna_bai_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(analysis.rna_bai_path_name)">cDNA BAI</a>
                                                                    <a href="{{currentTissueVariantReport.qc_report_url}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(analysis.qc_report_url)">QC Report</a>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-md-12 text-right">
                                                                    <a href="#" class="btn btn-xs btn-outline file-button-xs" ng-class="getAllFilesButtonClass(analysis, 'dna_bam_path_name', 'dna_bai_path_name', 'vcf_path', 'rna_bai_path_name', 'rna_bam_path_name')">All (Zip)</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li ng-if="shipment.analyses && shipment.analyses.length > 0 && shipment.analyses[shipment.analyses.length - 1].status === 'PENDING'" class="success-element">
                                                    <div class="row">
                                                        <div class="col-md-3 pull-right text-right">
                                                            <a ng-click="uploadSampleFile()" class="btn btn-xs btn-outline file-button-xs-3x btn-success" title="Upload new BAM file">Upload new sample file</a>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr ng-if="!currentSurgicalEvent.specimen_shipments || !currentSurgicalEvent.specimen_shipments.length">
                                        <td colspan="8"><span class="text-muted">No specimen history</span></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div ng-if="!currentSurgicalEvent">
                            <div class="row">
                                <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2">
                                    <div class="no-data-panel text-muted">
                                        <i class="fa fa-info-circle fa-2x"></i><span> The Surgical Event information has not been received.</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </uib-tab>

                <uib-tab heading="Tissue Reports" select="setActiveTab('tissue_report')">
                    <div class="panel-body">

                        <!--Variant Report-->
                        <div class="ibox">
                            <div class="ibox-title ibox-title-no-line-no-padding">
                                <h2>Variant Report</h2>
                            </div>
                            <div class="ibox-content ibox-content-no-padding ibox-title-no-line-no-padding">
                                <div ng-if="currentTissueVariantReport">

                                    <div class="row toolbar-row">
                                        <div class="col-md-8 text-left">
                                            <div class="btn-group btn-group-margin" data-toggle="buttons">
                                            </div>
                                            <div class="btn-group btn-group-margin" data-toggle="buttons">
                                                <label class="btn btn-outline btn-success" ng-class="getVariantReportModeClass('FILTERED')"
                                                       ng-click="setVariantReportMode('FILTERED')" title="Show Filtered Report">
                                                    <input type="radio" name="variantReportMode" id="option3">Filtered
                                                </label>
                                                <label class="btn btn-outline btn-success" ng-class="getVariantReportModeClass('QC')"
                                                       ng-click="setVariantReportMode('QC')" title="Show to QC Report">
                                                    <input type="radio" name="variantReportMode" id="option4">QC Report
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-4 text-right">
                                            <button class="btn btn-outline btn-success" title="Export Variant Report to Excel"><i class="fa fa-file-excel-o"></i>&nbsp;&nbsp;Excel</button>
                                        </div>
                                    </div>

                                    <div class="row content-select-list">
                                        <div class="col-md-12">
                                            <h4>
                                                <div class="btn-group" uib-dropdown dropdown-append-to-body>
                                                    <button id="btn-append-to-body-2" type="button" class="btn btn-success btn-outline" uib-dropdown-toggle>{{tissueVariantReportOption.text}}<span class="caret"></span></button>
                                                    <ul class="dropdown-menu" uib-dropdown-menu role="menu">
                                                        <li ng-repeat="item in tissueVariantReportOptions" role="menuitem"><a href ng-click="onTissueVariantReportSelected(item)">{{item.text}}</a></li>
                                                    </ul>
                                                </div>
                                            </h4>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="header-info-box  tissue-variant-report-header-box">
                                                <dl class="dl-horizontal">
                                                    <dt>Surgical Event ID</dt>
                                                    <dd>{{currentTissueVariantReport.surgical_event_id}}</dd>

                                                    <dt>Analysis ID</dt>
                                                    <dd>{{currentTissueVariantReport.analysis_id}}</dd>

                                                    <dt>Molecular ID</dt>
                                                    <dd>{{currentTissueVariantReport.molecular_id}}</dd>

                                                    <dt>Files</dt>
                                                    <dd>
                                                        <div class="row">
                                                            <div class="col-md-12 text-left">
                                                                <a href="{{currentTissueVariantReport.dna_bam_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentTissueVariantReport.dna_bam_path_name)">DNA BAM</a>
                                                                <a href="{{currentTissueVariantReport.dna_bai_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentTissueVariantReport.dna_bai_path_name)">DNA BAI</a>
                                                                <a href="{{currentTissueVariantReport.vcf_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentTissueVariantReport.vcf_path_name)">VCF</a>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-12 text-left">
                                                                <a href="{{currentTissueVariantReport.rna_bam_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentTissueVariantReport.rna_bam_path_name)">cDNA BAM</a>
                                                                <a href="{{currentTissueVariantReport.rna_bai_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentTissueVariantReport.rna_bai_path_name)">cDNA BAI</a>
                                                                <a href="{{currentTissueVariantReport.qc_report_url}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentTissueVariantReport.qc_report_url)">QC Report</a>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-12 text-left">
                                                                <a href="{{currentTissueVariantReport.dna_bam_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getAllFilesButtonClass(currentTissueVariantReport, 'dna_bam_path_name', 'dna_bai_path_name', 'vcf_path_name', 'rna_bai_file_path', 'rna_bam_file_path', 'qc_report')">All (Zip)</a>
                                                            </div>
                                                        </div>
                                                    </dd>

                                                    <dt>File Received Date</dt>
                                                    <dd>{{currentTissueVariantReport.variant_report_received_date | utc}}</dd>

                                                    <dt ng-show="variantReport.confirmedRejectedDate">{{currentTissueVariantReport.confirmedRejectedDateLabel}}</dt>
                                                    <dd ng-show="variantReport.confirmedRejectedDate">{{currentTissueVariantReport.confirmedRejectedDate | utc}}</dd>

                                                    <dt>Status</dt>
                                                    <dd style="color: {{currentTissueVariantReport.status | analysisStatus }}">{{currentTissueVariantReport.status}}
                                                        <span ng-if="currentTissueVariantReport.comment_user"> (user: {{currentTissueVariantReport.comment_user}})</span></dd>

                                                    <dt ng-if="currentTissueVariantReport.comment">Comments</dt>
                                                    <dd ng-if="currentTissueVariantReport.comment">{{currentTissueVariantReport.comment}}</dd>

                                                    <dt ng-if="needToDisplayReportStatus(currentTissueVariantReport)">{{currentTissueVariantReport.status | titlecase}} Date</dt>
                                                    <dd ng-if="needToDisplayReportStatus(currentTissueVariantReport)">{{currentTissueVariantReport.status_date | utc}}</dd>
                                                </dl>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="header-info-box tissue-variant-report-header-box">

                                                <dl class="dl-horizontal dl-horizontal-expanded-label">
                                                    <dt>Total Variants</dt>
                                                    <dd>{{currentTissueVariantReport.total_variants | dashify }}</dd>

                                                    <dt>Cellularity</dt>
                                                    <dd>{{currentTissueVariantReport.cellularity | dashify }}</dd>
                                                </dl>

                                                <dl class="dl-horizontal dl-horizontal-expanded-label" ng-if="variantReportMode=='QC'">
                                                    <dt>Oncomine Control Panel Summary</dt>
                                                    <dd class="row">
                                                        <table ng-if="currentTissueVariantReport.oncomine_report" class="table" role="grid" width="100">
                                                            <thead>
                                                            <td><a>LMNA</a></td>
                                                            <td><a>TBP</a></td>
                                                            <td><a>MYC</a></td>
                                                            <td><a>HMBS</a></td>
                                                            <td><a>ITGBY</a></td>
                                                            <td>SUM</td>
                                                            </thead>
                                                            <tbody class="priordrug-item" ng-repeat="oncomine in currentTissueVariantReport.oncomine_report" style="font-size: smaller">
                                                            <td>{{::oncomine.lmna | dashify }}</td>
                                                            <td>{{::oncomine.tbp | dashify }}</td>
                                                            <td>{{::oncomine.myc | dashify }}</td>
                                                            <td>{{::oncomine.hmbs | dashify }}</td>
                                                            <td>{{::oncomine.itgby | dashify }}</td>
                                                            <td>{{::oncomine.sum | dashify }}</td>
                                                            </tbody>
                                                        </table>
                                                        <p ng-if="!currentTissueVariantReport.oncomine_report"> - </p>
                                                    </dd>
                                                </dl>

                                                <h4 ng-if="variantReportMode!=='QC'">MOI/aMOI Summary</h4>

                                                <dl class="dl-horizontal dl-horizontal-expanded-label" ng-if="variantReportMode!=='QC'">
                                                    <dt>Total MOIs</dt>
                                                    <dd>{{currentTissueVariantReport.total_mois }}</dd>
                                                    <dt>Total aMOIs</dt>
                                                    <dd>{{currentTissueVariantReport.total_amois }}</dd>
                                                    <dt>Total Confirmed MOIs</dt>
                                                    <dd>{{currentTissueVariantReport.total_confirmed_mois }}</dd>
                                                    <dt>Total Confirmed aMOIs</dt>
                                                    <dd>{{currentTissueVariantReport.total_confirmed_amois }}</dd>
                                                </dl>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="panel panel-warning" ng-if="needToDisplayCbnaWarning()">
                                        <div class="panel-heading"><i class="fa fa-warning"></i>Warning</div>
                                        <div class="panel-body" id="selected-body">
                                            <p>cDNA is not present</p>
                                        </div>
                                    </div>

                                    <!--<div ng-if="activeTab=='tissue_report'" d3-cnv-chart="{{data.patient_id}}" chart-data-url="{{currentTissueVariantReport.vr_chart_data_url}}"></div>-->

                                    <div ng-if="variantReportMode === 'FILTERED'">
                                        <!--Single Nucleitide Variants-->
                                        <div class="ibox-title ibox-title-no-line-no-padding">
                                            <h3>SNVs/MNVs/Indels</h3>
                                        </div>

                                        <vr-filtered-snv-mnv-indel 
                                            grid-id="tissueFilteredSmiVr" 
                                            is-editable="currentTissueVariantReport.status==='PENDING'"
                                            items="currentTissueVariantReport.variants.snvs_and_indels"
                                            on-variant-confirmed="onItemConfirmed(variant)">
                                        </vr-filtered-snv-mnv-indel>

                                        <div class="table-responsive" style="border: none">
                                            <table datatable="ng"
                                                   dt-options="dtOptions"
                                                   dt-column-defs="dtColumnDefs"
                                                   dt-instance="dtInstance"
                                                   dt-columns="dtColumns"
                                                   class="table table-small-font table-striped" role="grid" >
                                            <thead>
                                            <tr>
                                                <th ng-if="variantReportMode!=='QC'">Confirm</th>
                                                <th ng-if="variantReportMode!=='QC'">Comment</th>
                                                <th>ID</th>
                                                <th ng-if="variantReportMode!=='QC'" style="width: 15%">aMOI</th>
                                                <th>Chrom</th>
                                                <th>Position</th>
                                                <th>CDS Ref</th>
                                                <th>CDS Alt</th>
                                                <th>OCP Ref</th>
                                                <th>OCP Alt</th>
                                                <th>Strand</th>
                                                <th>Allele Freq</th>
                                                <th>Func Gene</th>
                                                <th>Oncomine Variant Class</th>
                                                <th>Exon</th>
                                                <th>Function</th>
                                                <th>HGVS</th>
                                                <th>Read Depth</th>
                                                <th>Transcript</th>
                                                <th>Protein</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="variant in currentTissueVariantReport.variants.snvs_and_indels" style="cursor: auto;" role="row" class="odd">
                                                <td ng-if="variantReportMode!=='QC'">
                                                    <div check-box-with-confirm confirm-title="{{confirmTitle}}"
                                                         confirm-message="{{confirmMessage}}" is-checked="variant.confirmed"
                                                         comment="variant.comment" prompt-only-if="true"
                                                         enabled="currentTissueVariantReport.status==='PENDING'">
                                                    </div>
                                                </td>
                                                <td ng-if="variantReportMode!=='QC'">
                                                    <a ng-if="variant.comment " href ng-click="editComment(variant, currentTissueVariantReport.status==='PENDING' )">
                                                        <i class="fa fa-file-text-o "></i>
                                                    </a>
                                                    <p ng-if="!variant.comment"> - </p>
                                                </td>
                                                <td>
                                                    <a class="report-link" href ng-click="openCosmicId( variant.identifier )">
                                                        {{variant.identifier | dashify }}
                                                    </a>
                                                </td>
                                                <td ng-if="variantReportMode!=='QC'" style="width: 15%">
                                                    <treatment-arm-variant-link is-amoi="variant.is_amoi" treatment-arms="variant.treatment_arms"></treatment-arm-variant-link>
                                                </td>
                                                <td>{{::variant.chromosome | dashify }}</td>
                                                <td>{{::variant.position | dashify }}</td>
                                                <td>{{::variant.cds_reference | dashify }}</td>
                                                <td>{{::variant.cds_alternative | dashify }}</td>
                                                <td>{{::variant.ocp_reference | dashify }}</td>
                                                <td>{{::variant.ocp_alternative | dashify }}</td>
                                                <td>{{::variant.strand | dashify }}</td>
                                                <td>{{::variant.allele_frequency | dashify }}</td>
                                                <td>
                                                    <a class="report-link" href ng-click="openCosmicGene( variant.func_gene )">
                                                        {{variant.func_gene | dashify }}
                                                    </a>
                                                </td>
                                                <td>{{::variant.oncomine_variant_class | dashify }}</td>
                                                <td>{{::variant.exon | dashify }}</td>
                                                <td>{{::variant.function | dashify }}</td>
                                                <td>{{::variant.hgvs | dashify }}</td>
                                                <td>{{::variant.read_depth | dashify }}</td>
                                                <td>{{::variant.transcript | dashify }}</td>
                                                <td>{{::variant.protein | dashify }}</td>
                                            </tr>

                                            <tr ng-if="!currentTissueVariantReport.variants.snvs_and_indels || !currentTissueVariantReport.variants.snvs_and_indels.length">
                                                <td colspan="20"><span class="text-muted">No SNVs, MNVs or Indels</span></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        </div>

                                        <!--Copy Number Variants-->
                                        <div class="ibox-title ibox-title-no-line-no-padding">
                                            <h3>Copy Number Variants</h3>
                                        </div>
                                        
                                        <div class="table-responsive" style="border: none">
                                            <table datatable="ng"
                                                   dt-options="dtOptions"
                                                   dt-column-defs="dtColumnDefs"
                                                   dt-instance="dtInstance"
                                                   dt-columns="dtColumns"
                                                   class="table table-small-font table-striped" role="grid" >
                                                <thead>
                                                <tr>
                                                    <th ng-if="variantReportMode!=='QC'">Confirm</th>
                                                    <th ng-if="variantReportMode!=='QC'">Comment</th>
                                                    <th>ID</th>
                                                    <th ng-if="variantReportMode!=='QC'">aMOI</th>
                                                    <th>Chrom</th>
                                                    <th>Raw CN</th>
                                                    <th>CN</th>
                                                    <th>CI 5%</th>
                                                    <th>CI 95%</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr ng-repeat="variant in currentTissueVariantReport.variants.copy_number_variants" style="cursor: auto;" role="row" class="odd">
                                                    <td ng-if="variantReportMode!=='QC'">
                                                        <div check-box-with-confirm confirm-title="{{confirmTitle}}"
                                                             confirm-message="{{confirmMessage}}" is-checked="variant.confirmed"
                                                             comment="variant.comment" prompt-only-if="true"
                                                             enabled="currentTissueVariantReport.status==='PENDING'">
                                                        </div>
                                                    </td>
                                                    <td ng-if="variantReportMode!=='QC' ">
                                                        <a ng-if="variant.comment " href ng-click="editComment(variant, currentTissueVariantReport.status==='PENDING' )">
                                                            <i class="fa fa-file-text-o "></i>
                                                        </a>
                                                        <p ng-if="!variant.comment"> - </p>
                                                    </td>
                                                    <td>
                                                        <a href ng-click="openCosmicGene(variant.identifier)" class="report-link"> {{::variant.identifier | dashify }} </a>
                                                    </td>
                                                    <td ng-if="variantReportMode!=='QC'">
                                                        <treatment-arm-variant-link is-amoi="variant.is_amoi" treatment-arms="variant.treatment_arms"></treatment-arm-variant-link>
                                                    </td>
                                                    <td>{{variant.chromosome | dashify }}</td>
                                                    <td>{{variant.raw_copy_number | dashify }}</td>
                                                    <td>{{variant.copy_number | dashify }}</td>
                                                    <td>{{variant.confidence_interval_5percent | dashify }}</td>
                                                    <td>{{variant.confidence_interval_95percent | dashify }}</td>
                                                </tr>

                                                <tr ng-if="!currentTissueVariantReport.variants.copy_number_variants || !currentTissueVariantReport.variants.copy_number_variants.length">
                                                    <td colspan="9"><span class="text-muted">No Copy Number Variants</span></td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>

                                        <!--Gene Fusions-->
                                        <div class="ibox-title ibox-title-no-line-no-padding">
                                            <h3>Gene Fusions</h3>
                                        </div>

                                        <div class="table-responsive" style="border: none">
                                            <table datatable="ng"
                                                   dt-options="dtOptions"
                                                   dt-column-defs="dtColumnDefs"
                                                   dt-instance="dtInstance"
                                                   dt-columns="dtColumns"
                                                   class="table table-small-font table-striped" role="grid" >
                                                <thead>
                                                <tr>
                                                    <th ng-if="variantReportMode!=='QC'">Confirm</th>
                                                    <th ng-if="variantReportMode!=='QC'">Comment</th>
                                                    <th>ID</th>
                                                    <th ng-if="variantReportMode!=='QC'">aMOI</th>
                                                    <th>Gene 2</th>
                                                    <th>Gene 2 Count</th>
                                                    <th>Gene 1</th>
                                                    <th>Gene 1 Count</th>
                                                    <th>Annotation</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr ng-repeat="variant in currentTissueVariantReport.variants.gene_fusions" style="cursor: auto;" role="row" class="odd">
                                                    <td ng-if="variantReportMode!=='QC'">
                                                        <div check-box-with-confirm confirm-title="{{confirmTitle}}"
                                                             confirm-message="{{confirmMessage}}" is-checked="variant.confirmed" comment="variant.comment"
                                                             prompt-only-if="true" enabled="currentTissueVariantReport.status==='PENDING'">
                                                        </div>
                                                    </td>
                                                    <td ng-if="variantReportMode!=='QC'">
                                                        <a ng-if="variant.comment " href ng-click="editComment(variant, currentTissueVariantReport.status==='PENDING' )"> <i class="fa fa-file-text-o "></i></a>
                                                        <p ng-if="!variant.comment"> - </p>
                                                    </td>
                                                    <td>{{variant.identifier}}</td>
                                                    <td ng-if="variantReportMode!=='QC'">
                                                        <treatment-arm-variant-link is-amoi="variant.is_amoi" treatment-arms="variant.treatment_arms"></treatment-arm-variant-link>
                                                    </td>
                                                    <td>{{variant.driver_gene | dashify }}</td>
                                                    <td>{{variant.driver_read_count | dashify }}</td>
                                                    <td>
                                                        <a class="report-link" href ng-click="openCosmicGene( variant.partner_gene )">
                                                            {{variant.partner_gene | dashify }}
                                                        </a>
                                                    </td>
                                                    <td>{{variant.partner_rea_count | dashify }}</td>
                                                    <td>{{variant.annotation | dashify }}</td>
                                                </tr>

                                                <tr ng-if="!currentTissueVariantReport.variants.gene_fusions || !currentTissueVariantReport.variants.gene_fusions.length">
                                                    <td colspan="9"><span class="text-muted">No Gene Fusions</span></td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div ng-if="variantReportMode === 'QC'">

                                        <!--TABLES-->
                                        <div class="no-horizontal-padding header-box-container" >

                                            <div class="animated fadeInRight">

                                                <div class="row" >

                                                    <div class="col-lg-12">

                                                        <!--SNVs/MNVs/Indels TABLE-->
                                                        <div class="ibox-title ibox-title-no-line-no-padding">
                                                            <h3>SNVs/MNVs/Indels</h3>
                                                        </div>
                                                        <div class="col-md-12 white-bg animated fadeInRight"
                                                             ng-init="loadSnvTable()">

                                                            <table datatable="ng"
                                                                   dt-options="DashCtrl.dtOptions"
                                                                   dt-column-defs="DashCtrl.dtColumnDefs"
                                                                   dt-instance="DashCtrl.dtInstance"
                                                                   dt-columns="dtColumns"
                                                                   class="table table-striped table-bordered table-hover">
                                                                <thead>

                                                                <div class="form-group">
                                                                    <label>
                                                                        <div patientconfirmed="patientconfirmed" patient-element class="pull-right" style="width:200px"></div>
                                                                    </label>
                                                                </div>

                                                                <tr>
                                                                    <th class="label2" >Id</th>
                                                                    <th class="label2" >Chrom</th>
                                                                    <th class="label2" >Position</th>
                                                                    <th class="label2" >CDS Ref</th>
                                                                    <th class="label2" >CDS Alt</th>
                                                                    <th class="label2" >OCP Ref</th>
                                                                    <th class="label2" >OCP Alt</th>
                                                                    <th class="label2" >Strand</th>
                                                                    <th class="label2" >Filter</th>
                                                                    <th class="label2" >Allele Freq</th>
                                                                    <th class="label2" >Func Gene</th> <!-- openCosmicGene("MTOR") -->
                                                                    <th class="label2" >Oncomine Variant Class</th>
                                                                    <th class="label2" >Exon</th>
                                                                    <th class="label2" >Function</th>
                                                                    <th class="label2" >HGVS</th>
                                                                    <th class="label2" >Read Depth</th>
                                                                    <th class="label2" >Transcript</th>
                                                                    <th class="label2" >Protein</th>
                                                                </tr>

                                                                </thead>

                                                                <tbody>

                                                                <tr ng-repeat="variant in snvList | limitTo:totalDisplayed | filter:filterCol" style="cursor: auto; " role="row" class="odd">
                                                                    <td><a class="report-link" href ng-click="openCosmicId( variant.identifier )">{{variant.identifier | dashify }}</a></td>
                                                                    <td>{{::variant.chromosome | dashify }}</td>
                                                                    <td>{{::variant.position | dashify }}</td>
                                                                    <td>{{::variant.cds_reference | dashify }}</td>
                                                                    <td>{{::variant.cds_alternative | dashify }}</td>
                                                                    <td>{{::variant.ocp_reference | dashify }}</td>
                                                                    <td>{{::variant.ocp_alternative | dashify }}</td>
                                                                    <td>{{::variant.strand | dashify }}</td>
                                                                    <td>{{::variant.filter | dashify }}</td>
                                                                    <td>{{::variant.allele_frequency | dashify }}</td>
                                                                    <td><a href ng-click="openCosmicGene(variant.func_gene)" class="report-link">
                                                                        {{::variant.func_gene | dashify }}
                                                                        </a></td>
                                                                    <td>{{::variant.oncomine_variant_class | dashify }}</td>
                                                                    <td>{{::variant.exon | dashify }}</td>
                                                                    <td>{{::variant.function | dashify }}</td>
                                                                    <td>{{::variant.hgvs | dashify }}</td>
                                                                    <td>{{::variant.read_depth | dashify }}</td>
                                                                    <td>{{::variant.transcript | dashify }}</td>
                                                                    <td>{{::variant.protein | dashify }}</td>

                                                                </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <!--SNV TABLE-->

                                                        <!--CNV TABLE-->
                                                        <div class="ibox-title ibox-title-no-line-no-padding">
                                                            <h3>Copy Number Variants</h3>
                                                        </div>
                                                        <div class="col-md-12 white-bg animated fadeInRight"
                                                             ng-init="loadQcTable()">
                                                            <table datatable="ng"
                                                                   dt-options="DashCtrl.dtOptions"
                                                                   dt-column-defs="DashCtrl.dtColumnDefs"
                                                                   dt-instance="DashCtrl.dtInstance"
                                                                   dt-columns="dtColumns"
                                                                   class="table table-striped table-bordered table-hover">
                                                                <thead>

                                                                <div class="form-group">
                                                                    <label>
                                                                        <div patientconfirmed="patientconfirmed" patient-element class="pull-right" style="width:200px"></div>
                                                                    </label>
                                                                </div>

                                                                <tr>
                                                                    <th class="label2" >Id</th>
                                                                    <th class="label2" >Chrom</th>
                                                                    <th class="label2" >Position</th>
                                                                    <th class="label2" >Reference</th>
                                                                    <th class="label2" >Alternative</th>
                                                                    <th class="label2" >Filter</th>
                                                                    <th class="label2" >RAW Nc</th>
                                                                    <th class="label2" >FCN</th>
                                                                    <th class="label2" >Cl 5%</th>
                                                                    <th class="label2" >Cl 95%</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>

                                                                <tr ng-repeat="variant in cnvList | limitTo:totalDisplayed | filter:filterCol" style="cursor: auto; " role="row" class="odd">
                                                                    <td>
                                                                        <a href ng-click="openCosmicGene(variant.identifier)" class="report-link"> {{::variant.identifier | dashify }} </a>
                                                                    </td>
                                                                    <td>{{::variant.chromosome | dashify }}</td>
                                                                    <td>{{::variant.position | dashify }}</td>
                                                                    <td>{{::variant.reference | dashify }}</td>
                                                                    <td>{{::variant.alternative | dashify }}</td>
                                                                    <td>{{::variant.filter | dashify }}</td>
                                                                    <td>{{::variant.raw_copy_number | dashify }}</td>
                                                                    <td>{{::variant.copy_number | dashify }}</td>
                                                                    <td>{{::variant.confidence_interval_5percent | dashify }}</td>
                                                                    <td>{{::variant.confidence_interval_95percent | dashify }}</td>

                                                                </tr>
                                                                </tbody>
                                                            </table>

                                                        </div>
                                                        <!--CNV TABLE-->

                                                        <!--GENE TABLE-->
                                                        <div class="ibox-title ibox-title-no-line-no-padding">
                                                            <h3>Gene Fusions</h3>
                                                        </div>
                                                        <div class="col-md-12 white-bg animated fadeInRight"
                                                             ng-init="loadGeneTable()">
                                                            <table datatable="ng"
                                                                   dt-options="DashCtrl.dtOptions"
                                                                   dt-column-defs="DashCtrl.dtColumnDefs"
                                                                   dt-instance="DashCtrl.dtInstance"
                                                                   dt-columns="dtColumns"
                                                                   class="table table-striped table-bordered table-hover">
                                                                <thead>

                                                                <div class="form-group">
                                                                    <label>
                                                                        <div patientconfirmed="patientconfirmed" patient-element class="pull-right" style="width:200px"></div>
                                                                    </label>
                                                                </div>

                                                                <tr>
                                                                    <th class="label2" >Id</th> <!--openCosmicGene("ACVRL1")-->
                                                                    <th class="label2" >Chrom</th>
                                                                    <th class="label2" >Position</th>
                                                                    <th class="label2" >Reference</th>
                                                                    <th class="label2" >Alternative</th>
                                                                    <th class="label2" >Filter</th>
                                                                    <th class="label2" >Func Gene</th>
                                                                    <th class="label2" >Oncomine Variant Class</th>
                                                                    <th class="label2" >Exon</th>
                                                                    <th class="label2" >Function</th>
                                                                    <th class="label2" >Read Count</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>

                                                                <tr ng-repeat="variant in geneList | limitTo:totalDisplayed " style="cursor: auto; " role="row" class="odd">
                                                                    <td>
                                                                        <a href ng-click="openCosmicFusionId(variant.identifier)" class="report-link">
                                                                            {{::variant.identifier | dashify }}
                                                                        </a>
                                                                    </td>
                                                                    <td>{{::variant.chromosome | dashify }}</td>
                                                                    <td>{{::variant.position | dashify }}</td>
                                                                    <td>{{::variant.reference | dashify }}</td>
                                                                    <td>{{::variant.alternative | dashify }}</td>
                                                                    <td>{{::variant.filter | dashify }}</td>
                                                                    <td>{{::variant.func_gene | dashify }}</td>
                                                                    <td>{{::variant.oncomine_variant_class | dashify }}</td>
                                                                    <td>{{::variant.exon | dashify }}</td>
                                                                    <td>{{::variant.function | dashify }}</td>
                                                                    <td>{{::variant.read_depth | dashify }}</td>
                                                                </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <!--GENE TABLE-->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--TABLES-->
                                    </div>

                                    <div class="ibox-content ibox-title-no-line-no-padding" ng-if="showVariantReportActions(currentTissueVariantReport)">
                                        <div class="row">
                                            <div class="col-md-12 text-center">
                                                <button class="btn btn-danger" title="Reject this Report" ng-click="rejectVariantReport(currentTissueVariantReport)">REJECT</button>
                                                <button class="btn btn-success" title="Confirm this Report" ng-click="confirmVariantReport(currentTissueVariantReport)">CONFIRM</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div ng-if="!currentTissueVariantReport">
                                    <div class="row">
                                        <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2">
                                            <div class="no-data-panel text-muted">
                                                <i class="fa fa-info-circle fa-2x"></i><span> The Variant Report has not been received.</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--Assignment Report-->
                        <div ng-if="variantReportMode!=='QC'" class="ibox">
                            <div class="ibox-title ibox-title-no-line-no-padding">
                                <!--<div collapse-toggle-left></div>-->
                                <h2>Assignment Report</h2>
                            </div>

                            <div class="ibox-content ibox-content-no-padding ibox-title-no-line-no-padding">

                                <div ng-if="currentTissueVariantReport && currentTissueVariantReport.status=='CONFIRMED' && assignmentReportOptions.length" class="row content-select-list">
                                    <div class="col-md-12">
                                        <h4>
                                            <div class="btn-group" uib-dropdown dropdown-append-to-body>
                                                <button id="btn-append-to-body-3" type="button" class="btn btn-success btn-outline" uib-dropdown-toggle>{{assignmentReportOption.text}}<span class="caret"></span></button>
                                                <ul class="dropdown-menu" uib-dropdown-menu role="menu">
                                                    <li ng-repeat="item in assignmentReportOptions" role="menuitem"><a href ng-click="onAssignmentReportSelected(item)">{{item.text}}</a></li>
                                                </ul>
                                            </div>
                                        </h4>
                                    </div>
                                </div>

                                <div ng-if="currentTissueVariantReport && currentTissueVariantReport.status=='CONFIRMED' && assignmentReportOptions.length">
                                    <div class="row button-row">
                                        <div class="col-md-12 text-right">
                                            <button class="btn btn-success btn-outline" title="Export Assignment Report to Excel"><i class="fa fa-file-excel-o"></i>&nbsp;&nbsp;Excel</button>
                                        </div>
                                    </div>

                                    <div class="row" id="assignment-report">
                                        <div class="col-md-6">
                                            <div class="header-info-box assignment-header-box">
                                                <dl class="dl-horizontal">
                                                    <dt>Molecular ID</dt>
                                                    <dd>{{currentAssignmentReport.molecular_id | dashify }}</dd>

                                                    <dt>Analysis ID</dt>
                                                    <dd>{{currentAssignmentReport.analysis_id | dashify }}</dd>

                                                    <dt>Status</dt>
                                                    <dd style="{color:{{ currentAssignmentReport.status | analysisStatus }}">{{currentAssignmentReport.status | dashify }}
                                                        <span ng-if="currentAssignmentReport.comment_user"> (user: {{currentAssignmentReport.comment_user | dashify }})</span></dd>

                                                    <dt ng-if="currentAssignmentReport.comment">Comments</dt>
                                                    <dd ng-if="currentAssignmentReport.comment">{{currentAssignmentReport.comment | dashify }}</dd>

                                                    <dt ng-if="needToDisplayReportStatus(currentAssignmentReport)">{{currentAssignmentReport.status | titlecase | dashify }} Date</dt>
                                                    <dd ng-if="needToDisplayReportStatus(currentAssignmentReport)">{{currentAssignmentReport.status_date | utc | dashify }}</dd>
                                                </dl>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="header-info-box assignment-header-box">
                                                <h4>Assignment</h4>
                                                <dl class="dl-horizontal">
                                                    <dt>Generated Date</dt>
                                                    <dd>{{currentAssignmentReport.assigned_date | utc | dashify }}</dd>

                                                    <dt>Sent to COG Date</dt>
                                                    <dd>{{currentAssignmentReport.sent_to_cog_date | utc | dashify }}</dd>

                                                    <dt>Received from COG Date</dt>
                                                    <dd>{{currentAssignmentReport.received_from_cog_date | utc | dashify }}</dd>
                                                </dl>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="ibox-title ibox-title-no-line-no-padding">
                                        <h3>Assay</h3>
                                    </div>

                                    <table class="table table-hover" role="grid">
                                        <thead>
                                        <tr>
                                            <th width="20%">IHC</th>
                                            <th width="40%">Result</th>
                                            <th width="40%">Comment</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="assay in currentAssignmentReport.assays" style="cursor: auto; " role="row" class="odd">
                                            <td>{{assay.gene | dashify }}</td>
                                            <td><span style="{color:{{ assay.result | assayStatus }}">{{assay.result | dashify }}</span></td>
                                            <td>{{assay.comment | dashify }}</td>
                                        </tr>
                                        </tbody>
                                    </table>

                                    <div class="panel panel-primary">
                                        <div class="panel-heading"><i class="fa fa-bullseye"></i>Selected Treatment Arm:
                                            <span ng-if="!currentTreatmentArm">[None]</span>
                                            <treatment-arm-title ng-if="currentTreatmentArm" name="currentTreatmentArm.name" version="currentTreatmentArm.version" stratum="currentTreatmentArm.stratum" text-color="'#fff'"></treatment-arm-title></div>
                                        <div class="panel-body">
                                            <p ng-if="currentTreatmentArm">{{currentTreatmentArm.reason | dashify }}</p>
                                            <p ng-if="!currentTreatmentArm">No SELECTED logic was found in the current assignment</p>
                                        </div>
                                    </div>

                                    <div class="ibox-title ibox-title-no-line-no-padding">
                                        <h3>Assignment Logic</h3>
                                    </div>

                                    <table class="table table-hover" role="grid">
                                        <thead>
                                        <tr>
                                            <th width="30%">Treatment Arm</th>
                                            <th width="70%">Reason</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr class="table-subheader">
                                            <td colspan="2">
                                                <h5>1 - NO VARIANT MATCH</h5>
                                            </td>
                                        </tr>
                                        <tr ng-repeat="ta in currentAssignmentReport.assignmentLogic.no_match" style="cursor: auto;" role="row" class="odd">
                                            <td class="content-cell">
                                                <treatment-arm-title name="ta.treatmentArmName" version="ta.treatmentArmVersion" stratum="ta.treatmentArmStratumId"></treatment-arm-title>
                                            </td>
                                            <td>{{::ta.reason | dashify }}</td>
                                        </tr>
                                        <tr ng-if="!currentAssignmentReport.assignmentLogic.no_match.length" class="table-subheader">
                                            <td class="content-cell" colspan="2">No data available</td>
                                        </tr>

                                        <tr class="table-subheader ">
                                            <td colspan="2">
                                                <h5>2 - RECORD BASED EXCLUSION</h5>
                                            </td>
                                        </tr>
                                        <tr ng-repeat="ta in currentAssignmentReport.assignmentLogic.record_based_exclusion" style="cursor: auto;" role="row " class="odd ">
                                            <td class="content-cell">
                                                <treatment-arm-title name="ta.treatmentArmName" version="ta.treatmentArmVersion" stratum="ta.treatmentArmStratumId"></treatment-arm-title>
                                            </td>
                                            <td>{{::ta.reason | dashify }}</td>
                                        </tr>
                                        <tr ng-if="!currentAssignmentReport.assignmentLogic.record_based_exclusion.length" class="table-subheader ">
                                            <td class="content-cell" colspan="2">No data available</td>
                                        </tr>

                                        <tr class="table-subheader ">
                                            <td colspan="2">
                                                <h5>3 - SELECTED</h5>
                                            </td>
                                        </tr>
                                        <tr ng-repeat="ta in currentAssignmentReport.assignmentLogic.selected" style="cursor: auto; " role="row" class="odd">
                                            <td class="content-cell">
                                                <treatment-arm-title name="ta.treatmentArmName" version="ta.treatmentArmVersion" stratum="ta.treatmentArmStratumId"></treatment-arm-title>
                                            </td>
                                            <td>{{::ta.reason | dashify }}</td>
                                        </tr>
                                        <tr ng-if="!currentAssignmentReport.assignmentLogic.selected.length" class="table-subheader ">
                                            <td class="content-cell" colspan="2">No data available</td>
                                        </tr>

                                        </tbody>
                                    </table>

                                    <div class="ibox-content ibox-title-no-line-no-padding" ng-if="showAssignmentReportActions(currentAssignmentReport)">
                                        <div class="row">
                                            <div class="col-md-12 text-center">
                                                <!-- RZ:Removed for now <button class="btn btn-danger" title="Reject this Report" ng-click="rejectAssignmentReport(currentAssignmentReport)">REJECT</button>-->
                                                <button class="btn btn-success" title="Confirm this Report" ng-click="confirmAssignmentReport(currentAssignmentReport)">CONFIRM</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div ng-if="!(currentTissueVariantReport && currentTissueVariantReport.status=='CONFIRMED' && assignmentReportOptions.length)">
                                    <div class="row">
                                        <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2">
                                            <div ng-if="data.current_status === 'PENDING_CONFIRMATION'" class="no-data-panel text-muted">
                                                <i class="fa fa-info-circle fa-2x"></i><span> Assignment Report is being generated. Please refresh the page to see up-to-date data.</span>
                                            </div>
                                            <div ng-if="data.current_status !== 'PENDING_CONFIRMATION'" class="no-data-panel text-muted">
                                                <i class="fa fa-info-circle fa-2x"></i><span> Assignment Report is not yet available.</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </uib-tab>

                <uib-tab heading="Blood Variant Reports" select="setActiveTab('blood_variant_report')">
                    <div class="panel-body">

                        <div ng-if="currentBloodVariantReport">
                            <div class="row toolbar-row">
                                <div class="col-md-8 text-left">
                                    <div class="btn-group btn-group-margin" data-toggle="buttons">
                                        <label class="btn btn-outline btn-success" ng-class="getVariantReportModeClass('FILTERED')" ng-click="setVariantReportMode('FILTERED')" title="Show Filtered Report">
                                            <input type="radio" name="variantReportMode" id="option3_1">Filtered
                                        </label>
                                        <label class="btn btn-outline btn-success" ng-class="getVariantReportModeClass('QC')" ng-click="setVariantReportMode('QC')" title="Show to QC Report">
                                            <input type="radio" name="variantReportMode" id="option4_1">QC Report
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-4 text-right">
                                    <button class="btn btn-outline btn-success" title="Export Variant Report to Excel"><i class="fa fa-file-excel-o"></i>&nbsp;&nbsp;Excel</button>
                                </div>
                            </div>

                            <div class="row content-select-list">
                                <div class="col-md-12">
                                    <h4>
                                        <div class="btn-group" uib-dropdown dropdown-append-to-body>
                                            <button id="btn-append-to-body-4" type="button" class="btn btn-success btn-outline" uib-dropdown-toggle>{{bloodVariantReportOption.text}}<span class="caret"></span></button>
                                            <ul class="dropdown-menu" uib-dropdown-menu role="menu">
                                                <li ng-repeat="item in bloodVariantReportOptions" role="menuitem"><a href ng-click="onBloodVariantReportSelected(item)">{{item.text}}</a></li>
                                            </ul>
                                        </div>
                                    </h4>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="header-info-box  blood-variant-report-header-box">
                                        <dl class="dl-horizontal">
                                            <dt>Analysis ID</dt>
                                            <dd>{{currentBloodVariantReport.analysis_id}}</dd>

                                            <dt>Molecular ID</dt>
                                            <dd>{{currentBloodVariantReport.molecular_id}}</dd>

                                            <dt>Files</dt>
                                            <dd>
                                                <div class="row">
                                                    <div class="col-md-12 text-left">
                                                        <a href="{{currentBloodVariantReport.dna_bam_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentBloodVariantReport.dna_bam_path_name)">DNA BAM</a>
                                                        <a href="{{currentBloodVariantReport.dna_bai_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentBloodVariantReport.dna_bai_path_name)">DNA BAI</a>
                                                        <a href="{{currentBloodVariantReport.vcf_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentBloodVariantReport.vcf_path_name)">VCF</a>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12 text-left">
                                                        <a href="{{currentBloodVariantReport.rna_bam_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentBloodVariantReport.rna_bam_path_name)">cDNA BAM</a>
                                                        <a href="{{currentBloodVariantReport.rna_bai_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentBloodVariantReport.rna_bai_path_name)">cDNA BAI</a>
                                                        <a href="{{currentBloodVariantReport.qc_report_url}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getFileButtonClass(currentBloodVariantReport.qc_report_url)">QC Report</a>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12 text-left">
                                                        <a href="{{currentBloodVariantReport.dna_bam_path_name}}" class="btn btn-xs btn-outline file-button-xs" ng-class="getAllFilesButtonClass(currentBloodVariantReport, 'dna_bam_path_name', 'dna_bai_path_name', 'vcf_path_name', 'rna_bai_file_path', 'rna_bam_file_path', 'qc_report')">All (Zip)</a>
                                                    </div>
                                                </div>
                                            </dd>

                                            <dt>File Received Date</dt>
                                            <dd>{{currentBloodVariantReport.variant_report_received_date | utc}}</dd>

                                            <dt>Status</dt>
                                            <dd style="{color:{{ currentBloodVariantReport.status | analysisStatus }}">{{currentBloodVariantReport.status}}<span ng-if="currentBloodVariantReport.comment_user"> (user: {{currentBloodVariantReport.comment_user}})</span></dd>

                                            <dt ng-if="currentBloodVariantReport.comment">Comments</dt>
                                            <dd ng-if="currentBloodVariantReport.comment">{{currentBloodVariantReport.comment}}</dd>

                                            <dt ng-if="needToDisplayReportStatus(currentBloodVariantReport)">{{currentBloodVariantReport.status | titlecase}} Date</dt>
                                            <dd ng-if="needToDisplayReportStatus(currentBloodVariantReport)">{{currentBloodVariantReport.status_date | utc}}</dd>
                                        </dl>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="header-info-box blood-variant-report-header-box">

                                        <dl class="dl-horizontal dl-horizontal-expanded-label">
                                            <dt>Total Variants</dt>
                                            <dd>{{currentBloodVariantReport.total_variants | dashify }}</dd>

                                            <dt>Cellularity</dt>
                                            <dd>{{currentBloodVariantReport.cellularity | dashify }}</dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>

                            <div ng-if="activeTab=='blood_variant_report'" d3-cnv-chart="{{data.patient_id}}"></div>

                            <!--FILTERED-->
                            <div ng-if="variantReportMode === 'FILTERED'">
                                <!--Single Nucleitide Variants-->
                                <div class="ibox-title ibox-title-no-line-no-padding">
                                    <h3>SNVs/MNVs/Indels</h3>
                                </div>

                                <div class="table-responsive" style="border: none">
                                    <table datatable="ng"
                                           dt-options="dtOptions"
                                           dt-column-defs="dtColumnDefs"
                                           dt-instance="dtInstance"
                                           dt-columns="dtColumns"
                                           class="table table-small-font table-striped" role="grid" >
                                        <thead>
                                        <tr>
                                            <th ng-if="variantReportMode!=='QC'">Confirm</th>
                                            <th ng-if="variantReportMode!=='QC'">Comment</th>
                                            <th>ID</th>
                                            <th ng-if="variantReportMode!=='QC'">aMOI</th>
                                            <th>Chrom</th>
                                            <th>Position</th>
                                            <th>CDS Ref</th>
                                            <th>CDS Alt</th>
                                            <th>OCP Ref</th>
                                            <th>OCP Alt</th>
                                            <th>Strand</th>
                                            <th>Allele Freq</th>
                                            <th>Func Gene</th>
                                            <th>Oncomine Variant Class</th>
                                            <th>Exon</th>
                                            <th>Function</th>
                                            <th>HGVS</th>
                                            <th>Read Depth</th>
                                            <th>Transcript</th>
                                            <th>Protein</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="variant in currentBloodVariantReport.variants.snvs_and_indels" style="cursor: auto;" role="row" class="odd">
                                            <td ng-if="variantReportMode!=='QC'">
                                                <div check-box-with-confirm confirm-title="{{confirmTitle}}"
                                                        confirm-message="{{confirmMessage}}" is-checked="variant.confirmed"
                                                        comment="variant.comment" prompt-only-if="true" enabled="currentTissueVariantReport.status==='PENDING'">
                                                </div>
                                            </td>
                                            <td ng-if="variantReportMode!=='QC'">
                                                <a ng-if="variant.comment " href
                                                   ng-click="editComment(variant, currentTissueVariantReport.status==='PENDING' )"> <i class="fa fa-file-text-o "></i></a>
                                                <p ng-if="!variant.comment"> - </p>
                                            </td>
                                            <td>
                                                <a class="report-link" href ng-click="openCosmicId( variant.identifier )">
                                                    {{variant.identifier | dashify }}
                                                </a>
                                            </td>
                                            <td ng-if="variantReportMode!=='QC'">
                                                <treatment-arm-variant-link is-amoi="variant.is_amoi" treatment-arms="variant.treatment_arms"></treatment-arm-variant-link>
                                            </td>
                                            <td>{{::variant.chromosome | dashify }}</td>
                                            <td>{{::variant.position | dashify }}</td>
                                            <td>{{::variant.cds_reference | dashify }}</td>
                                            <td>{{::variant.cds_alternative | dashify }}</td>
                                            <td>{{::variant.ocp_reference | dashify }}</td>
                                            <td>{{::variant.ocp_alternative | dashify }}</td>
                                            <td>{{::variant.strand | dashify }}</td>
                                            <td>{{::variant.allele_frequency | dashify }}</td>
                                            <td>
                                                <a class="report-link" href ng-click="openCosmicGene( variant.func_gene )">
                                                    {{variant.func_gene }}
                                                </a>
                                                <p ng-if="!variant.func_gene"> - </p>
                                            </td>
                                            <td>{{::variant.oncomine_variant_class | dashify }}</td>
                                            <td>{{::variant.exon | dashify }}</td>
                                            <td>{{::variant.function | dashify }}</td>
                                            <td>{{::variant.hgvs | dashify }}</td>
                                            <td>{{::variant.read_depth | dashify }}</td>
                                            <td>{{::variant.transcript | dashify }}</td>
                                            <td>{{::variant.protein | dashify }}</td>
                                        </tr>

                                        <tr ng-if="!currentBloodVariantReport.variants.snvs_and_indels || !currentBloodVariantReport.variants.snvs_and_indels.length">
                                            <td colspan="20"><span class="text-muted">No SNVs, MNVs or Indels</span></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <!--Copy Number Variants-->
                                <div class="ibox-title ibox-title-no-line-no-padding">
                                    <h3>Copy Number Variants</h3>
                                </div>
                                        
                                <div class="table-responsive" style="border: none">
                                    <table datatable="ng"
                                            dt-options="dtOptions"
                                            dt-column-defs="dtColumnDefs"
                                            dt-instance="dtInstance"
                                            dt-columns="dtColumns"
                                            class="table table-small-font table-striped" role="grid" >
                                        <thead>
                                        <tr>
                                            <th ng-if="variantReportMode!=='QC'">Confirm</th>
                                            <th ng-if="variantReportMode!=='QC'">Comment</th>
                                            <th>ID</th>
                                            <th ng-if="variantReportMode!=='QC'">aMOI</th>
                                            <th>Chrom</th>
                                            <th>Raw CN</th>
                                            <th>CN</th>
                                            <th>CI 5%</th>
                                            <th>CI 95%</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="variant in currentBloodVariantReport.variants.copy_number_variants" style="cursor: auto;" role="row" class="odd">
                                            <td ng-if="variantReportMode!=='QC'">
                                                <div check-box-with-confirm confirm-title="{{confirmTitle}}" confirm-message="{{confirmMessage}}"
                                                     is-checked="variant.confirmed" comment="variant.comment" prompt-only-if="true"
                                                     enabled="currentTissueVariantReport.status==='PENDING'">
                                                </div>
                                            </td>
                                            <td ng-if="variantReportMode!=='QC' ">
                                                <a ng-if="variant.comment " href ng-click="editComment(variant, currentTissueVariantReport.status==='PENDING' )"> <i class="fa fa-file-text-o "></i></a>
                                                <p ng-if="!variant.comment"> - </p>
                                            </td>
                                            <td>
                                                <a href ng-click="openCosmicGene(variant.identifier)" class="report-link"> {{::variant.identifier | dashify }} </a>
                                            </td>
                                            <td ng-if="variantReportMode!=='QC'">
                                                <treatment-arm-variant-link is-amoi="variant.is_amoi" treatment-arms="variant.treatment_arms"></treatment-arm-variant-link>
                                            </td>
                                            <td>{{variant.chromosome | dashify }}</td>
                                            <td>{{variant.raw_copy_number | dashify }}</td>
                                            <td>{{variant.copy_number | dashify }}</td>
                                            <td>{{variant.confidence_interval_5percent | dashify }}</td>
                                            <td>{{variant.confidence_interval_95percent | dashify }}</td>
                                        </tr>

                                        <tr ng-if="!currentBloodVariantReport.variants.copy_number_variants || !currentBloodVariantReport.variants.copy_number_variants.length">
                                            <td colspan="9"><span class="text-muted">No Copy Number Variants</span></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <!--Gene Fusions-->
                                <div class="ibox-title ibox-title-no-line-no-padding">
                                    <h3>Gene Fusions</h3>
                                </div>

                                <div class="table-responsive" style="border: none">
                                    <table datatable="ng"
                                            dt-options="dtOptions"
                                            dt-column-defs="dtColumnDefs"
                                            dt-instance="dtInstance"
                                            dt-columns="dtColumns"
                                            class="table table-small-font table-striped" role="grid" >
                                        <thead>
                                        <tr>
                                            <th ng-if="variantReportMode!=='QC'">Confirm</th>
                                            <th ng-if="variantReportMode!=='QC'">Comment</th>
                                            <th>ID</th>
                                            <th ng-if="variantReportMode!=='QC'">aMOI</th>
                                            <th>Gene 2</th>
                                            <th>Gene 2 Count</th>
                                            <th>Gene 1</th>
                                            <th>Gene 1 Count</th>
                                            <th>Annotation</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="variant in currentBloodVariantReport.variants.gene_fusions" style="cursor: auto;" role="row" class="odd">
                                            <td ng-if="variantReportMode!=='QC'">
                                                <div check-box-with-confirm confirm-title="{{confirmTitle}}" confirm-message="{{confirmMessage}}"
                                                     is-checked="variant.confirmed" comment="variant.comment" prompt-only-if="true"
                                                     enabled="currentTissueVariantReport.status==='PENDING'">
                                                </div>
                                            </td>
                                            <td ng-if="variantReportMode!=='QC'">
                                                <a ng-if="variant.comment " href ng-click="editComment(variant, currentTissueVariantReport.status==='PENDING' )"> <i class="fa fa-file-text-o "></i></a>
                                                <p ng-if="!variant.comment"> - </p>
                                            </td>
                                            <td>{{variant.identifier}}</td>
                                            <td ng-if="variantReportMode!=='QC'">
                                                <treatment-arm-variant-link is-amoi="variant.is_amoi" treatment-arms="variant.treatment_arms"></treatment-arm-variant-link>
                                            </td>
                                            <td>{{variant.driver_gene | dashify }}</td>
                                            <td>{{variant.driver_read_count | dashify }}</td>
                                            <td>
                                                <a class="report-link" href ng-click="openCosmicGene( variant.partner_gene )">
                                                    {{variant.partner_gene | dashify }}
                                                </a>
                                            </td>
                                            <td>{{variant.partner_rea_count | dashify }}</td>
                                            <td>{{variant.annotation | dashify }}</td>
                                        </tr>

                                        <tr ng-if="!currentBloodVariantReport.variants.gene_fusions || !currentBloodVariantReport.variants.gene_fusions.length">
                                            <td colspan="9"><span class="text-muted">No Gene Fusions</span></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                            <!--FILTERED-->

                            <!--QC-->
                            <div ng-if="variantReportMode === 'QC'">

                                <!--TABLES-->
                                <div class="no-horizontal-padding header-box-container" >

                                    <div class="animated fadeInRight">

                                        <div class="row" >

                                            <div class="col-lg-12">

                                                <!--SNVs/MNVs/Indels TABLE-->
                                                <div class="ibox-title ibox-title-no-line-no-padding">
                                                    <h3>SNVs/MNVs/Indels</h3>
                                                </div>
                                                <div class="col-md-12 white-bg animated fadeInRight"
                                                     ng-init="loadSnvTable()">

                                                    <table datatable="ng"
                                                           dt-options="DashCtrl.dtOptions"
                                                           dt-column-defs="DashCtrl.dtColumnDefs"
                                                           dt-instance="DashCtrl.dtInstance"
                                                           dt-columns="dtColumns"
                                                           class="table table-striped table-bordered dataTable table-hover">
                                                        <thead>

                                                        <div class="form-group">
                                                            <label>
                                                                <div patientconfirmed="patientconfirmed" patient-element class="pull-right" style="width:200px"></div>
                                                            </label>
                                                        </div>

                                                        <tr>
                                                            <th class="label2" >Id</th>
                                                            <th class="label2" >Chrom</th>
                                                            <th class="label2" >Position</th>
                                                            <th class="label2" >Reference</th>
                                                            <th class="label2" >Alternative</th>
                                                            <th class="label2" >Filter</th>
                                                            <th class="label2" >Allele Freq</th>
                                                            <th class="label2" >Func Gene</th> <!-- openCosmicGene("MTOR") -->
                                                            <th class="label2" >Oncomine Variant Class</th>
                                                            <th class="label2" >Exon</th>
                                                            <th class="label2" >Function</th>
                                                            <th class="label2" >HGVS</th>
                                                            <th class="label2" >Read Depth</th>
                                                            <th class="label2" >Transcript</th>
                                                            <th class="label2" >Protein</th>
                                                        </tr>

                                                        </thead>

                                                        <tbody>

                                                        <tr ng-repeat="ta in snvList | limitTo:totalDisplayed | filter:filterCol" style="cursor: auto; " role="row" class="odd">
                                                            <td>
                                                                <a class="report-link" href ng-click="openCosmicId( variant.identifier )">
                                                                    {{variant.identifier | dashify }}
                                                                </a>
                                                            </td>
                                                            <td>{{::variant.chromosome | dashify }}</td>
                                                            <td>{{::variant.position | dashify }}</td>
                                                            <td>{{::variant.cds_reference | dashify }}</td>
                                                            <td>{{::variant.cds_alternative | dashify }}</td>
                                                            <td>{{::variant.ocp_reference | dashify }}</td>
                                                            <td>{{::variant.ocp_alternative | dashify }}</td>
                                                            <td>{{::variant.strand | dashify }}</td>
                                                            <td>{{::variant.filter | dashify }}</td>
                                                            <td>{{::variant.allele_frequency | dashify }}</td>
                                                            <td>
                                                                <a href ng-click="openCosmicGene(variant.func_gene)"
                                                                   class="report-link">
                                                                    {{::variant.func_gene | dashify }}
                                                                </a>
                                                                <!--<p ng-if="!variant.func_gene"> - </p>-->
                                                            </td>
                                                            <td>{{::variant.oncomine_variant_class | dashify }}</td>
                                                            <td>{{::variant.exon | dashify }}</td>
                                                            <td>{{::variant.function | dashify }}</td>
                                                            <td>{{::variant.hgvs | dashify }}</td>
                                                            <td>{{::variant.read_depth | dashify }}</td>
                                                            <td>{{::variant.transcript | dashify }}</td>
                                                            <td>{{::variant.protein | dashify }}</td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <!--SNV TABLE-->

                                                <!--CNV TABLE-->
                                                <div class="ibox-title ibox-title-no-line-no-padding">
                                                    <h3>Copy Number Variants</h3>
                                                </div>
                                                <div class="col-md-12 white-bg animated fadeInRight"
                                                     ng-init="loadQcTable()">
                                                    <table datatable="ng"
                                                           dt-options="DashCtrl.dtOptions"
                                                           dt-column-defs="DashCtrl.dtColumnDefs"
                                                           dt-instance="DashCtrl.dtInstance"
                                                           dt-columns="dtColumns"
                                                           class="table table-striped table-bordered table-hover">
                                                        <thead>

                                                        <div class="form-group">
                                                            <label>
                                                                <div patientconfirmed="patientconfirmed" patient-element class="pull-right" style="width:200px"></div>
                                                            </label>
                                                        </div>

                                                        <tr>
                                                            <th class="label2" >Id</th>
                                                            <th class="label2" >Chrom</th>
                                                            <th class="label2" >Position</th>
                                                            <th class="label2" >Reference</th>
                                                            <th class="label2" >Alternative</th>
                                                            <th class="label2" >Filter</th>
                                                            <th class="label2" >RAW Nc</th>
                                                            <th class="label2" >FCN</th>
                                                            <th class="label2" >Cl 5%</th>
                                                            <th class="label2" >Cl 95%</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>

                                                        <tr ng-repeat="variant in cnvList | limitTo:tovariantlDisplayed | filter:filterCol" style="cursor: auto; " role="row" class="odd">
                                                            <td>
                                                                <a href ng-click="openCosmicGene(variant.identifier)" class="report-link"> {{::variant.identifier | dashify }} </a>
                                                            </td>
                                                            <td>{{::variant.chromosome | dashify }}</td>
                                                            <td>{{::variant.position | dashify }}</td>
                                                            <td>{{::variant.reference | dashify }}</td>
                                                            <td>{{::variant.alternative | dashify }}</td>
                                                            <td>{{::variant.filter | dashify }}</td>
                                                            <td>{{::variant.raw_copy_number | dashify }}</td>
                                                            <td>{{::variant.copy_number | dashify }}</td>
                                                            <td>{{::variant.confidence_interval_5percent | dashify }}</td>
                                                            <td>{{::variant.confidence_interval_95percent | dashify }}</td>
                                                        </tr>
                                                        </tbody>
                                                    </table>

                                                </div>
                                                <!--CNV TABLE-->

                                                <!--GENE TABLE-->
                                                <div class="ibox-title ibox-title-no-line-no-padding">
                                                    <h3>Gene Fusions</h3>
                                                </div>
                                                <div class="col-md-12 white-bg animated fadeInRight"
                                                     ng-init="loadGeneTable()">
                                                    <table datatable="ng"
                                                           dt-options="DashCtrl.dtOptions"
                                                           dt-column-defs="DashCtrl.dtColumnDefs"
                                                           dt-instance="DashCtrl.dtInstance"
                                                           dt-columns="dtColumns"
                                                           class="table table-striped table-bordered table-hover">
                                                        <thead>

                                                        <div class="form-group">
                                                            <label>
                                                                <div patientconfirmed="patientconfirmed" patient-element class="pull-right" style="width:200px"></div>
                                                            </label>
                                                        </div>

                                                        <tr>
                                                            <th class="label2" >Id</th> <!--openCosmicGene("ACVRL1")-->
                                                            <th class="label2" >Chrom</th>
                                                            <th class="label2" >Position</th>
                                                            <th class="label2" >Reference</th>
                                                            <th class="label2" >Alternative</th>
                                                            <th class="label2" >Filter</th>
                                                            <th class="label2" >Func Gene</th>
                                                            <th class="label2" >Oncomine Variant Class</th>
                                                            <th class="label2" >Exon</th>
                                                            <th class="label2" >Function</th>
                                                            <th class="label2" >Read Count</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>

                                                        <tr ng-repeat="variant in geneList | limitTo:totalDisplayed " style="cursor: auto; " role="row" class="odd">
                                                            <td>
                                                                <a href ng-click="openCosmicFusionId(variant.identifier)" class="report-link"> {{::variant.identifier | dashify }} </a>
                                                            </td>
                                                            <td>{{::variant.chromosome | dashify }}</td>
                                                            <td>{{::variant.position | dashify }}</td>
                                                            <td>{{::variant.reference | dashify }}</td>
                                                            <td>{{::variant.alternative | dashify }}</td>
                                                            <td>{{::variant.filter | dashify }}</td>
                                                            <td>{{::variant.func_gene | dashify }}</td>
                                                            <td>{{::variant.oncomine_variant_class | dashify }}</td>
                                                            <td>{{::variant.exon | dashify }}</td>
                                                            <td>{{::variant.function | dashify }}</td>
                                                            <td>{{::variant.read_depth | dashify }}</td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <!--GENE TABLE-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--TABLES-->

                            </div>
                            <!--QC-->

                            <div class="ibox-content ibox-title-no-line-no-padding" ng-if="showVariantReportActions(currentBloodVariantReport)">
                                <div class="row">
                                    <div class="col-md-12 text-center">
                                        <button class="btn btn-danger" title="Reject this Report" ng-click="rejectVariantReport(currentBloodVariantReport)">REJECT</button>
                                        <button class="btn btn-success" title="Confirm this Report" ng-click="confirmVariantReport(currentBloodVariantReport)">CONFIRM</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div ng-if="!currentBloodVariantReport">
                            <div class="row">
                                <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2">
                                    <div class="no-data-panel text-muted">
                                        <i class="fa fa-info-circle fa-2x"></i><span> The Blood Variant Report has not been received.</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </uib-tab>

                <uib-tab heading="Documents" select="setActiveTab('documents')">
                    <div class="panel-body ">

                        <div class="ibox float-e-margins">
                            <div class="ibox-title ibox-title-no-line-no-padding">
                                <h3>Patient Documents</h3>
                            </div>

                            <table class="table table-hover" role="grid">
                                <thead>
                                <tr>
                                    <th width="20%" class="label2 sorting_disabled">Document</th>
                                    <th width="40%" class="label2 sorting_disabled">Comment</th>
                                    <th width="20%" class="label2 sorting_disabled">Uploaded Date</th>
                                    <th width="10%" class="label2 sorting_disabled">User</th>
                                </tr>
                                </thead>

                                <tbody>
                                <tr ng-repeat="document in data.documents.list" style="cursor: auto;" role="row" class="odd">
                                    <td><a href="{{document.url}}" target="_blank">{{document.name | dashify }}</a></td>
                                    <td>{{document.comment | dashify }}</td>
                                    <td>{{document.uploaded_date | utc | dashify }}</td>
                                    <td>{{document.user | dashify }}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                        <form class="dropzone" method="post" enctype="multipart/form-data" ng-dropzone dropzone="dropzone" dropzone-config="dropzoneConfig" event-handlers="{ 'addedfile': dzAddedFile, 'error': dzError }">
                        </form>
                    </div>
                </uib-tab>
            </uib-tabset>
        </div>
    </div>
</div>